{{very long|rps=113|date=November 2016}}

'''Computational anatomy''' is an interdisciplinary field of [[biology]] focused on quantitative investigation and modelling of anatomical shapes variability.<ref>{{Cite web|url=https://team.inria.fr/asclepios/research/computational-anatomy/|title=Computational Anatomy – Asclepios|website=team.inria.fr|language=en-US|access-date=2018-01-01}}</ref><ref>{{Cite web|url=https://icm.jhu.edu/research-areas-2/computational-anatomy/|title=JHU – Institute for Computational Medicine {{!}} Computational Anatomy|website=icm.jhu.edu|access-date=2018-01-01}}</ref> It involves the development and application of mathematical, statistical and data-analytical methods for modelling and simulation of biological structures.

The field is broadly defined and includes foundations in [[anatomy]], [[applied mathematics]] and [[pure mathematics]], [[machine learning]], [[computational mechanics]], [[computational science]], [[biological imaging]], [[neuroscience]], [[physics]], [[probability]], and [[statistics]]; it also has strong connections with [[fluid mechanics]] and [[geometric mechanics]]. Additionally, it complements newer, interdisciplinary fields like [[bioinformatics]] and [[neuroinformatics]] in the sense that its interpretation uses metadata derived from the original sensor imaging modalities (of which [[Magnetic Resonance Imaging]] is one example). It focuses on the anatomical structures being imaged, rather than the medical imaging devices. It is similar in spirit to the history of [[Computational linguistics]], a discipline that focuses on the linguistic structures rather than the [[sensor]] acting as the [[transmission medium|transmission]] and communication media.

In computational anatomy, the [[diffeomorphism]] group is used to study different coordinate systems via [[change of basis|coordinate transformations]] as generated via the [[Lagrangian and Eulerian specification of the flow field|Lagrangian and Eulerian velocities of flow]] in <math>{\mathbb R}^3</math>. The [[#Lagrangian and Eulerian flows for generating diffeomorphisms|flows between coordinates in computational anatomy]] are constrained to be [[#The Metric on geodesic flows of landmarks, surfaces, and volumes within the orbit|geodesic flows]] satisfying [[#The action integral for Hamilton's principle on diffeomorphic flows|the principle of least action for the Kinetic energy of the flow]]. The kinetic energy is defined through a [[#The Sobolev smoothness condition on vector fields as modeled in a reproducing kernel Hilbert space|Sobolev smoothness]] norm with strictly more than two generalized, [[square-integrable function|square-integrable]] derivatives for each component of the flow velocity, which guarantees that the flows in <math>\mathbb{R}^3</math> are diffeomorphisms.<ref>{{Cite web|title=Variational Problems on Flows of Diffeomorphisms for Image Matching|url=https://www.researchgate.net/publication/2693614|website=ResearchGate|access-date=2016-02-20|last1=Dupuis|first1=Paul|authorlink=|last2=Grenander|first2=Ulf|authorlink2=|authorlink3=|last3=Miller, Michael|author-first#=}}</ref> 
It also implies that the [[#The Sobolev smoothness condition on vector fields as modeled in a reproducing kernel Hilbert space|diffeomorphic shape momentum]] taken pointwise satisfying the [[#The Euler–Lagrange equation on shape momentum for geodesics on the group of diffeomorphisms|Euler-Lagrange equation for geodesics]] is determined by its neighbors through spatial derivatives on the velocity field.  This separates the discipline from the case of [[Incompressible flow|incompressible fluids]]<ref name=MR202082>{{Cite journal|mr=202082|title=Sur la géomérie différentielle des groupes de Lie de dimension infinie et ses applications à l'hydrodynamique des fluides parfaits|journal=Ann. Inst. Fourier|volume=16|year=1966|issue=1|pages=319–361|language=French|last=Arnold|first=V.|doi=10.5802/aif.233|doi-access=free}}</ref> for which momentum is a pointwise function of velocity. Computational anatomy intersects the study of [[Riemannian manifolds]] and nonlinear [[global analysis]], where groups of diffeomorphisms are the central focus. Emerging high-dimensional theories of shape<ref>{{Cite book|author=Laurent Younes|title=Shapes and Diffeomorphisms|publisher=Springer|isbn=9783642120541|date=2010-05-25 }}</ref> are central to many studies in computational anatomy, as are questions emerging from the fledgling field of [[shape statistics]].
The metric structures in computational anatomy are related in spirit to [[morphometrics]], with the distinction that Computational anatomy focuses on an infinite-dimensional space of [[coordinate system]]s transformed by a [[diffeomorphism]], hence the central use of the terminology [[#Diffeomorphometry: The Metric Space of Shapes and Forms|'''diffeomorphometry''']], the metric space study of coordinate systems via diffeomorphisms.

==Genesis==
At computational anatomy's heart is the comparison of shape by recognizing in one shape the other. This connects it to [[D'Arcy Wentworth Thompson]]'s developments [[On Growth and Form]] <nowiki/>which has led to scientific explanations of [[morphogenesis]], the process by which [[patterns]] are formed in [[Biology]]. [[Albrecht Dürer|Albrecht Durer]]'s Four Books on Human Proportion were arguably the earliest works on computational anatomy.<ref>{{Cite book|url=https://archive.org/details/hierinnsindbegri00dure|title=Hierinn sind begriffen vier Bucher von menschlicher Proportion durch Albrechten Durer von Nurerberg [sic.] erfunden und beschuben zu nutz allen denen so zu diser kunst lieb tragen|last=Durer|first=Albrecht|year=1528|publisher=Hieronymus Andreae Formschneider}}</ref><ref>{{Cite web|url=http://library.uthscsa.edu/2012/03/albrecht-durers-human-proportions/|title=Albrecht Dürer's Human Proportions " UT Health Science Center Library|last=Library|first=State of Texas, University of Texas Health Science Center at San Antonio|website=library.uthscsa.edu|access-date=2016-03-16}}</ref><ref>{{Cite web|url=http://www.themorgan.org/collection/printed-books-and-bindings/73192|title=Albrecht Dürer|website=The Morgan Library & Museum|access-date=2016-03-16|date=2014-01-07}}</ref> The efforts of [[Noam Chomsky]] in his pioneering of [[Computational Linguistics]] inspired the original formulation of computational anatomy as a generative model of shape and form from exemplars acted upon via transformations.<ref name=":20">{{Cite journal|title=Computational Anatomy: An Emerging Discipline|url=http://dl.acm.org/citation.cfm?id=309082.309089|journal=Q. Appl. Math.|volume=56|issue=4|pages=617–694|date=1998-12-01|first1=Ulf|last1=Grenander|first2=Michael I.|last2=Miller|doi=10.1090/qam/1668732|doi-access=free}}</ref>

Due to the availability of dense 3D measurements via technologies such as [[magnetic resonance imaging]] (MRI), computational anatomy has emerged as a subfield of [[medical imaging]] and [[bioengineering]] for extracting anatomical coordinate systems at the morphome scale in 3D. The spirit of this discipline shares strong overlap with areas such as [[computer vision]] and [[kinematics]] of [[rigid bodies]], where objects are studied by analysing the [[group (mathematics)|groups]] responsible for the movement in question. Computational anatomy departs from computer vision with its focus on rigid motions, as the infinite-dimensional diffeomorphism group is central to the analysis of Biological shapes. It is a branch of the image analysis and pattern theory school at Brown University<ref>{{Cite web|title=Brown University -- Pattern Theory Group: Home|url=http://www.dam.brown.edu/ptg/participants.shtml|website=www.dam.brown.edu|accessdate=2015-12-27}}</ref> pioneered by [[Ulf Grenander]]. In Grenander's general Metric [[Pattern Theory]], making spaces of '''patterns''' into a [[Complete metric space|metric space]] is one of the fundamental operations since being able to cluster and recognize anatomical configurations often requires a metric of close and far between shapes. The [[#The Right Invariant Metric on Diffeomorphism|diffeomorphometry metric]]<ref name="Miller 36"/> of Computational anatomy measures how far two diffeomorphic changes of coordinates are from each other, which in turn induces a [[#The Metric on Shapes and Forms|metric on the shapes and images]] indexed to them. The models of metric pattern theory,<ref>{{Cite book|title=General Pattern Theory : A Mathematical Study of Regular Structures|author=Grenander, Ulf|year=1993|publisher=Oxford University Press|isbn=9780198536710}}</ref><ref>{{Cite book|title=Pattern Theory: From Representation to Inference|author=U. Grenander and M. I. Miller|publisher=Oxford University Press|date=2007-02-08|location=Oxford|isbn=9780199297061}}</ref> in particular group action on the orbit of shapes and forms is a central tool to the formal definitions in Computational anatomy.

==History==
Computational anatomy is the study of shape and form at the [[morphome]] or [[gross anatomy]] millimeter, or [[morphology (biology)|morphology]] scale, focusing on the study of sub-[[manifolds]] of <math>{\mathbb R}^3,</math> points, curves surfaces and subvolumes of human anatomy.
An early modern computational neuro-anatomist was David Van Essen<ref>{{Cite journal|title=Two-dimensional maps of the cerebral cortex|journal=The Journal of Comparative Neurology|date=1980-05-15|pmid=7410593|pages=255–281|volume=191|issue=2|doi=10.1002/cne.901910208|first1=D. C.|last1=Van Essen|first2=J. H.|last2=Maunsell|s2cid=25729587}}</ref> performing some of the early physical unfoldings of the human brain based on printing of a human cortex and cutting. [[Jean Talairach|Jean Talairach's]]  publication of [[Talairach coordinates]] is an important milestone at the morphome scale demonstrating the fundamental basis of local coordinate systems in studying neuroanatomy and therefore the clear link to [[Differential geometry|charts of differential geometry]]. Concurrently, virtual mapping in computational anatomy across high resolution dense image coordinates was already happening in [[Ruzena Bajcsy|Ruzena Bajcy's]]<ref>{{Cite journal|title=Multiresolution Elastic Matching|journal=Comput. Vision Graph. Image Process.|date=1989-04-01|pages=1–21|volume=46|issue=1|doi=10.1016/S0734-189X(89)80014-3|first1=Ruzena|last1=Bajcsy|first2=Stane|last2=Kovačič}}</ref> and Fred Bookstein's<ref>{{Cite journal|title=Principal Warps: Thin-Plate Splines and the Decomposition of Deformations|journal=IEEE Trans. Pattern Anal. Mach. Intell.|date=1989-06-01|pages=567–585|volume=11|issue=6|doi=10.1109/34.24792|first=F. L.|last=Bookstein|s2cid=47302}}</ref>  earliest developments based on [[Computed Tomography|Computed axial tomography]] and [[Magnetic resonance imaging|Magnetic resonance imagery]].
The earliest introduction of the use of flows of diffeomorphisms for transformation of coordinate systems in image analysis and medical imaging was by Christensen, Joshi, Miller, and Rabbitt.<ref name="Christensen">{{Cite book|url=https://books.google.com/books?id=tVVGAQAAIAAJ|title=A deformable neuroanatomy textbook based on viscous fluid mechanics: Proceedings of the ... Conference on Information Sciences and Systems|last1=Christensen|first1=Gary|last2=Rabbitt|first2=Richard|last3=Miller|first3=Michael I.|date=1993-01-01|publisher=Department of Electrical Engineering, Johns Hopkins University|editor-last=Jerry Prince }}</ref><ref name="Christensen 1435–1447">{{Cite journal|title=Deformable Templates Using Large Deformation Kinematics|journal=Trans. Img. Proc.|date=1996-10-01|pages=1435–1447|volume=5|issue=10|doi=10.1109/83.536892|first1=G. E.|last1=Christensen|first2=R. D.|last2=Rabbitt|first3=M. I.|last3=Miller|pmid=18290061|bibcode=1996ITIP....5.1435C}}</ref><ref name=":14">{{Cite book|url=https://books.google.com/books?id=8WdlWJepgWMC&q=info:fFDvh9Q-I8cJ:scholar.google.com&pg=PA115|title=Brain Warping: Chapter 7: Large Deformation Fluid Diffeomorphisms for Landmark and Image Matching|last1=Miller|first1=Michael|last2=Joshi|first2=Sarang|last3=Christensen|last4=Brain Warping Book Author: Toga|first4=Arthur|year=1997|isbn=9780080525549|location=|pages=115}}</ref>

The first formalization of computational anatomy as an orbit of exemplar templates under [[diffeomorphism]] [[Group action (mathematics)|group action]] was in the original lecture given by Grenander and Miller with that title in May 1997 at the 50th Anniversary of the Division of Applied Mathematics at Brown University,<ref>{{Cite journal|editor=Walter Freiberger|title=Current and Future Challenges in the Applications of Mathematics|journal=Quarterly of Applied Mathematics }}</ref> and subsequent publication.<ref name=":20" /> This was the basis for the strong departure from much of the previous work on advanced methods for [[spatial normalization]] and [[image registration]] which were historically built on notions of addition and basis expansion. The structure preserving transformations central to the modern field of Computational Anatomy, [[homeomorphism]]s and [[diffeomorphism]]s carry smooth submanifolds smoothly. They are generated via [[Lagrangian and Eulerian specification of the flow field|Lagrangian and Eulerian flows]] which <nowiki/>satisfy a law of composition of functions forming the group property, but are not additive.

The original model of computational anatomy was as the triple, <math>(\mathcal{G}, \mathcal{M}, \mathcal{P}) \ ,
</math> the group  <math> g \in \mathcal{G} </math>, the orbit of shapes and forms <math> m \in \mathcal{M} </math>, and the probability laws <math>P</math> which encode the variations of the objects in the orbit. The template or collection of templates are elements in the orbit <math> m_\mathrm{temp} \in \mathcal {M} </math> of shapes.

The Lagrangian and Hamiltonian formulations of the equations of motion of computational anatomy took off post 1997 with several pivotal meetings including the 1997 Luminy meeting<ref>{{Cite web|title=Colloque Mathematiques et reconnaissance de formes|url=https://www.ceremade.dauphine.fr/~cohen/MSPCV/luminy.html|website=www.ceremade.dauphine.fr|accessdate=2015-12-19}}</ref> organized by the Azencott<ref>{{Cite web|title=Robert Azencott, mathématicien polyglotte {{!}} La Recherche|url=http://www.larecherche.fr/actualite/aussi/robert-azencott-mathematicien-polyglotte-01-12-2000-70634|website=www.larecherche.fr|access-date=2016-02-20}}</ref> school at [[École Normale Supérieure|Ecole-Normale Cachan]] on the "Mathematics of Shape Recognition" and the 1998 Trimestre at [[Institut Henri Poincaré|Institute Henri Poincar]]é organized by [[David Mumford]] "Questions Mathématiques en Traitement du Signal et de l'Image"  which catalyzed the Hopkins-Brown-ENS Cachan groups and subsequent developments and connections of Computational anatomy to developments in global analysis.

The developments in computational anatomy included the establishment of the Sobelev smoothness conditions on the diffeomorphometry metric to insure existence of solutions of [[Calculus of variations|variational]] problems in the space of diffeomorphisms,<ref>{{Cite web|url=http://www.dam.brown.edu/people/mariom/AM282-01/PAPERS/LANDMARK/an-approach-of-pattern.pdf|title=An Approach of Pattern Recognition through Infinite Dimensional Diffeomorphism|date=|accessdate=|website=|last=Trouve|first=Alain|archive-url=https://web.archive.org/web/20160304190038/http://www.dam.brown.edu/people/mariom/AM282-01/PAPERS/LANDMARK/an-approach-of-pattern.pdf|archive-date=2016-03-04|url-status=dead}}</ref><ref name=":142">{{Cite journal|title=Variational Problems on Flows of Diffeomorphisms for Image Matching|url=http://dl.acm.org/citation.cfm?id=298828.298844|journal=Q. Appl. Math.|date=1998-09-01|pages=587–600|volume=LVI|issue=3|first1=Paul|last1=Dupuis|first2=Ulf|last2=Grenander|doi = 10.1090/qam/1632326|doi-access=free}}</ref> the derivation of the Euler-Lagrange equations characterizing geodesics through the group and associated conservation laws,<ref>{{Cite journal|title=On the metrics and euler-lagrange equations of computational anatomy|journal=Annual Review of Biomedical Engineering|date=2002-01-01|pmid=12117763|pages=375–405|volume=4|doi=10.1146/annurev.bioeng.4.092101.125733|first1=Michael I.|last1=Miller|first2=Alain|last2=Trouve|first3=Laurent|last3=Younes|citeseerx=10.1.1.157.6533}}</ref><ref name="Miller 209–228">{{Cite journal|title=Geodesic Shooting for Computational Anatomy|journal=Journal of Mathematical Imaging and Vision|date=2006-01-28|pmc=2897162|pmid=20613972|pages=209–228|volume=24|issue=2|doi=10.1007/s10851-005-3624-0|first1=Michael I.|last1=Miller|first2=Alain|last2=Trouvé|first3=Laurent|last3=Younes}}</ref><ref name="Miller 447–509">{{Cite journal|last1=Miller|first1=Michael I.|last2=Trouvé|first2=Alain|last3=Younes|first3=Laurent|date=2015-12-07|title=Hamiltonian Systems and Optimal Control in Computational Anatomy: 100 Years Since D'Arcy Thompson|journal=Annual Review of Biomedical Engineering|volume=17|pages=447–509|doi=10.1146/annurev-bioeng-071114-040601|pmid=26643025}}</ref> the demonstration of the metric properties of the right invariant metric,<ref name=":8">{{Cite journal|title=Group Actions, Homeomorphisms, and Matching: A General Framework|journal=Int. J. Comput. Vis.|date=2001-01-01|pages=61–84|volume=41|issue=1–2|doi=10.1023/A:1011161132514|first1=M. I.|last1=Miller|first2=L.|last2=Younes|s2cid=15423783}}</ref> the demonstration that the Euler-Lagrange equations have a well-posed initial value problem with unique solutions for all time,<ref>{{Cite journal|title=Local Geometry of Deformable Templates|journal=SIAM Journal on Mathematical Analysis|date=2005-01-01|pages=17–59|volume=37|issue=1|doi=10.1137/S0036141002404838|first1=A.|last1=Trouvé|first2=L.|last2=Younes|citeseerx=10.1.1.158.302}}</ref> and with the first results on sectional curvatures for the diffeomorphometry metric in landmarked spaces.<ref>{{Cite journal|title=Sectional Curvature in Terms of the Cometric, with Applications to the Riemannian Manifolds of Landmarks|journal=SIAM J. Imaging Sci.|date=2012-03-01|pages=394–433|volume=5|issue=1|doi=10.1137/10081678X|first1=Mario|last1=Micheli|first2=Peter W.|last2=Michor|first3=David|last3=Mumford|arxiv=1009.2637|s2cid=2301243}}</ref> Following the Los Alamos meeting in 2002,<ref>{{Cite web|title=Home Page|url=http://cnls.lanl.gov/~rgarcia/Conferences/ImageAnalysis/|website=cnls.lanl.gov|accessdate=2015-12-19}}</ref> Joshi's<ref name="Joshi 1357–1370">{{Cite journal|title=Landmark matching via large deformation diffeomorphisms|journal=IEEE Transactions on Image Processing|date=2000-01-01|pmid=18262973|pages=1357–1370|volume=9|issue=8|doi=10.1109/83.855431|first1=S. C.|last1=Joshi|first2=M. I.|last2=Miller|s2cid=6659707|bibcode=2000ITIP....9.1357J}}</ref> original large deformation singular ''Landmark'' solutions in Computational anatomy were connected to peaked [[Soliton|''Solitons'']] or [[Peakon|''Peakons'']]<ref>{{Cite book|chapter=Peakons|title=Encyclopedia of Mathematical Physics|editor=J.-P. Francoise |editor2=G.L. Naber |editor3=S.T. Tsou|location=Oxford|publisher=Elsevier|volume=4|issue=2006|pages=12–20|arxiv=0908.4351|date=2009-08-29|first=Darryl D.|last=Holm|bibcode=2009arXiv0908.4351H }}</ref> as solutions for the [[Camassa–Holm equation|Camassa-Holm]] equation. Subsequently, connections were made between Computational anatomy's Euler-Lagrange equations for momentum densities for the right-invariant metric satisfying Sobolev smoothness to [[Vladimir Arnold|Vladimir Arnold's]]<ref name=MR202082/> characterization of the [[Euler equations (fluid dynamics)|Euler equation]] for incompressible flows as describing geodesics in the group of volume preserving diffeomorphisms.<ref>{{Cite journal|title=Groups of diffeomorphisms and the solution of the classical Euler equations for a perfect fluid|url=http://projecteuclid.org/euclid.bams/1183530815|journal=Bulletin of the American Mathematical Society|date=1969-09-01|pages=962–967|volume=75|issue=5|first1=David G.|last1=Ebin|first2=Jerrold E.|last2=Marsden|doi=10.1090/s0002-9904-1969-12315-3|doi-access=free}}</ref><ref name="Mumford">{{Cite journal|title=On Euler's equation and 'EPDiff'|journal=Journal of Geometric Mechanics|volume=5|issue=3|pages=319–344|arxiv=1209.6576|date=2013|doi=10.3934/jgm.2013.5.319|first1=David|last1=Mumford|first2=Peter W.|last2=Michor|bibcode=2012arXiv1209.6576M }}</ref> The first algorithms, generally termed LDDMM for large deformation diffeomorphic mapping for computing connections between landmarks in volumes<ref name="Joshi 1357–1370" /><ref>{{Cite book|title=Handbook of Mathematical Methods in Imaging|url=https://books.google.com/books?id=FzvNfkMjvPwC|publisher=Springer Science & Business Media|date=2010-11-23|isbn=9780387929194|first=Otmar|last=Scherzer}}</ref><ref>{{Cite book|doi=10.1109/CVPR.2004.1315234|first1=J.|last1=Glaunes|first2=A.|last2=Trouve|first3=L.|last3=Younes|isbn=978-0-7695-2158-9|citeseerx=10.1.1.158.4209|chapter=Diffeomorphic matching of distributions: A new approach for unlabelled point-sets and sub-manifolds matching|title=Proceedings of the 2004 IEEE Computer Society Conference on Computer Vision and Pattern Recognition, 2004. CVPR 2004|volume=2|pages=712–718|year=2004}}</ref> and spherical manifolds,<ref>{{Cite journal|url=https://www.researchgate.net/publication/263559913|title=Landmark Matching via Large Deformation Diffeomorphisms on the Sphere: Special Issue on Mathematics and Image Analysis|journal=Journal of Mathematical Imaging and Vision|volume=20|pages=179–200|via=ResearchGate|doi=10.1023/B:JMIV.0000011326.88682.e5|access-date=2016-03-27|year=2004|last1=Glaunès|first1=Joan|last2=Vaillant|first2=Marc|last3=Miller|first3=Michael I|s2cid=21324161}}</ref> curves,<ref>{{Cite journal|title=Whole brain diffeomorphic metric mapping via integration of sulcal and gyral curves, cortical surfaces, and images|journal=NeuroImage|date=2011-05-01|pmc=3119076|pmid=21281722|pages=162–173|volume=56|issue=1|doi=10.1016/j.neuroimage.2011.01.067|first1=Jia|last1=Du|first2=Laurent|last2=Younes|first3=Anqi|last3=Qiu}}</ref> currents and surfaces,<ref name=":18" /><ref name="Vaillant 1149–1159">{{Cite journal|title=Diffeomorphic Metric Surface Mapping in Superior Temporal Gyrus|journal=NeuroImage|date=2007-02-01|pmc=3140704|pmid=17185000|pages=1149–1159|volume=34|issue=3|doi=10.1016/j.neuroimage.2006.08.053|first1=Marc|last1=Vaillant|first2=Anqi|last2=Qiu|first3=Joan|last3=Glaunès|first4=Michael I.|last4=Miller}}</ref><ref>{{Cite journal|title=Statistical models of sets of curves and surfaces based on currents|journal=Medical Image Analysis|date=2009-10-01|pmid=19679507|pages=793–808|volume=13|issue=5|doi=10.1016/j.media.2009.07.007|first1=Stanley|last1=Durrleman|first2=Xavier|last2=Pennec|first3=Alain|last3=Trouvé|first4=Nicholas|last4=Ayache|citeseerx=10.1.1.221.5224}}</ref> volumes,<ref>{{Cite journal|title=Computing Large Deformation Metric Mappings via Geodesic Flows of Diffeomorphisms|journal=International Journal of Computer Vision|volume=61|issue=2|pages=139–157|author=M.F. Beg and M. I. Miller and A. Trouve and L. Younes|url=https://www.researchgate.net/publication/220660081|via=ResearchGate|access-date=2016-01-27|doi=10.1023/B:VISI.0000043755.93987.aa|year=2005 |s2cid=17772076}}</ref> tensors,<ref>{{Cite book |date=2006-07-05|pmc=2920614|pmid=20711423|pages=67|volume=2006|doi=10.1109/CVPRW.2006.65|first1=Yan|last1=Cao|first2=Michael I.|last2=Miller|first3=Susumu|last3=Mori|first4=Raimond L.|last4=Winslow|first5=Laurent|last5=Younes|isbn=978-0-7695-2646-1|chapter=Diffeomorphic Matching of Diffusion Tensor Images|title=2006 Conference on Computer Vision and Pattern Recognition Workshop (CVPRW'06)|journal=Proceedings. IEEE Computer Society Conference on Computer Vision and Pattern Recognition}}</ref> varifolds,<ref name="Charon 2547–2580">{{Cite journal|title=The varifold representation of non-oriented shapes for diffeomorphic registration|arxiv=1304.6108|journal=SIAM Journal on Imaging Sciences|pages=2547–2580|volume=6|issue=4|doi=10.1137/130918885|first1=Nicolas|last1=Charon|first2=Alain|last2=Trouvé|year=2013|bibcode=2013arXiv1304.6108C|s2cid=14335966}}</ref> and time-series<ref name=":15" /><ref>{{Cite arXiv|title=Shape Splines and Stochastic Shape Evolutions: A Second Order Point of View|eprint=1003.3895|date=2010-03-19|first1=Alain|last1=Trouvé|first2=François-Xavier|last2=Vialard|class=math.OC }}</ref><ref>{{Cite journal|title=Principal geodesic analysis for the study of nonlinear statistics of shape|journal=[[IEEE Transactions on Medical Imaging]]|date=2004-08-01|pages=995–1005|volume=23|issue=8|doi=10.1109/TMI.2004.831793|pmid=15338733|first1=P.T.|last1=Fletcher|first2=C.|last2=Lu|first3=S.M.|last3=Pizer|first4=S.|last4=Joshi|citeseerx=10.1.1.76.539|s2cid=620015}}</ref> have followed.

These contributions of computational anatomy to the global analysis associated to the infinite dimensional manifolds of subgroups of the diffeomorphism group is far from trivial. The original idea of doing differential geometry, curvature and geodesics on infinite dimensional manifolds goes back to [[Bernhard Riemann]]'s [[Habilitation]] (Ueber die Hypothesen, welche der Geometrie zu Grunde liegen<ref>{{Cite web|url=http://www.maths.tcd.ie/pub/HistMath/People/Riemann/Geom/|title=Ueber die Hypothesen, welche der Geometrie zu Grunde liegen|website=www.maths.tcd.ie|access-date=2016-03-16|url-status=dead|archiveurl=https://web.archive.org/web/20160318034045/http://www.maths.tcd.ie/pub/HistMath/People/Riemann/Geom/|archivedate=2016-03-18}}</ref><ref>{{Cite book|isbn=9783642351204|author=Bernhard Riemann|title=Über die Hypothesen, welche der Geometrie|publisher=Springer}}</ref>); the key modern book laying the foundations of such ideas in global analysis are from Michor.<ref>{{Cite book|author=Peter W. Michor|title=Topics in Differential Geometry|date=2008-07-23|publisher=American Mathematical Society|isbn=9780821820032 }}</ref>

The applications within medical imaging of computational anatomy continued to flourish after two organized meetings at the [[Institute for Pure and Applied Mathematics]] conferences<ref>{{Cite journal|url=http://www.sciencedirect.com/science/journal/10538119/23/supp/S1|journal=NeuroImage|volume=23|issue=Supplement 1|pages=S1–S300|year=2004|title=Mathematics in Brain Imaging}}</ref><ref>{{Cite journal|journal=NeuroImage|volume=45|issue=Supplement 1|pages=S1–S222|year=2009|url=http://www.sciencedirect.com/science/journal/10538119/45/1/supp/S1|title=Mathematics in Brain Imaging|doi=10.1016/j.neuroimage.2008.10.033|pmid=19027863|last1=Thompson|first1=Paul M.|last2=Miller|first2=Michael I.|last3=Poldrack|first3=Russell A.|last4=Nichols|first4=Thomas E.|last5=Taylor|first5=Jonathan E.|last6=Worsley|first6=Keith J.|last7=Ratnanather|first7=J. Tilak|s2cid=12143788}}</ref> at [[University of California, Los Angeles]]. Computational anatomy has been useful in creating accurate models of the atrophy of the human brain at the morphome scale,  as well as Cardiac templates,<ref>{{Cite journal|last1=Fonseca|first1=Carissa G.|last2=Backhaus|first2=Michael|last3=Bluemke|first3=David A.|last4=Britten|first4=Randall D.|last5=Chung|first5=Jae Do|last6=Cowan|first6=Brett R.|last7=Dinov|first7=Ivo D.|last8=Finn|first8=J. Paul|last9=Hunter|first9=Peter J.|date=2011-08-15|title=The Cardiac Atlas Project--an imaging database for computational modeling and statistical atlases of the heart|journal=Bioinformatics|volume=27|issue=16|pages=2288–2295|doi=10.1093/bioinformatics/btr360|pmc=3150036|pmid=21737439}}</ref> as well as in modeling biological systems.<ref>{{Cite web|url=http://cellorganizer.org/Downloads/v1.8/RELEASE_NOTES.pdf|title=CellOrganizer 1.8 Release Notes|date=|access-date=|website=}}</ref> Since the late 1990s, computational anatomy has become an important part of developing emerging technologies for the field of medical imaging. Digital atlases are a fundamental part of modern Medical-school education<ref>{{Cite book|author=Jamie Weir|edition=4th|title=Imaging Atlas of Human Anatomy|publisher=Mosby|date=2010-03-09|location=Edinburgh|isbn=9780723434573|display-authors=etal}}</ref><ref>{{Cite web|title=The Whole Brain Atlas|url=http://www.med.harvard.edu/aanlib/home.html|website=www.med.harvard.edu|access-date=2016-01-26|url-status=dead|archiveurl=https://web.archive.org/web/20160118132843/http://www.med.harvard.edu/aanlib/home.html|archivedate=2016-01-18}}</ref> and in neuroimaging research at the morphome scale.<ref>{{Cite journal|title=A probabilistic atlas and reference system for the human brain: International Consortium for Brain Mapping (ICBM)|journal=Philosophical Transactions of the Royal Society of London B|date=2001-08-29|pmc=1088516|pmid=11545704|pages=1293–1322|volume=356|issue=1412|doi=10.1098/rstb.2001.0915|first1=J|last1=Mazziotta|first2=A|last2=Toga|first3=A|last3=Evans|first4=P|last4=Fox|first5=J|last5=Lancaster|first6=K|last6=Zilles|first7=R|last7=Woods|first8=T|last8=Paus|first9=G|last9=Simpson}}</ref><ref>{{Cite web|title=White Matter Atlas - Diffusion Tensor Imaging Atlas of the Brain's White Matter Tracts|url=http://www.dtiatlas.org/|website=www.dtiatlas.org|access-date=2016-01-26}}</ref> Atlas based methods and virtual textbooks<ref>{{Cite journal|title=Mathematical textbook of deformable neuroanatomies|journal=Proceedings of the National Academy of Sciences of the United States of America|date=1993-12-15|pmc=48101|pmid=8265653|pages=11944–11948|volume=90|issue=24|first1=M I|last1=Miller|first2=G E|last2=Christensen|first3=Y|last3=Amit|first4=U|last4=Grenander|doi=10.1073/pnas.90.24.11944|bibcode=1993PNAS...9011944M}}</ref> which accommodate variations as in deformable templates are at the center of many neuro-image analysis platforms including Freesurfer,<ref>{{Cite web|title=FreeSurfer|url=http://freesurfer.net/|website=freesurfer.net|accessdate=2015-12-08}}</ref> FSL,<ref>{{Cite web|title=FSL - FslWiki|url=http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/|website=fsl.fmrib.ox.ac.uk|accessdate=2015-12-08}}</ref> MRIStudio,<ref>{{Cite web|title=NITRC: MRI Studio: Tool/Resource Info|url=https://www.nitrc.org/projects/mri_studio/|website=www.nitrc.org|accessdate=2015-12-08}}</ref> SPM.<ref>{{Cite web|title=SPM software - Statistical Parametric Mapping|url=http://www.fil.ion.ucl.ac.uk/spm/software/|website=www.fil.ion.ucl.ac.uk|accessdate=2015-12-08}}</ref> Diffeomorphic registration,<ref name="Christensen 1435–1447" /> introduced in the 1990s, is now an important player with existing codes bases organized around ANTS,<ref name="stnava/ANTs">{{Cite web|title=stnava/ANTs|url=https://github.com/stnava/ANTs/blob/master/Scripts/antsIntroduction.sh|website=GitHub|accessdate=2015-12-11}}</ref> DARTEL,<ref name="Ashburner 95–113">{{Cite journal|title=A fast diffeomorphic image registration algorithm|journal=NeuroImage|date=2007-10-15|pmid=17761438|pages=95–113|volume=38|issue=1|doi=10.1016/j.neuroimage.2007.07.007|first=John|last=Ashburner|s2cid=545830}}</ref> DEMONS,<ref name="Software - Tom Vercauteren">{{Cite web|title=Software - Tom Vercauteren|url=https://sites.google.com/site/tomvercauteren/software|website=sites.google.com|accessdate=2015-12-11}}</ref> LDDMM,<ref name="NITRC: LDDMM: Tool/Resource Info">{{Cite web|title=NITRC: LDDMM: Tool/Resource Info|url=https://www.nitrc.org/projects/lddmm-volume/|website=www.nitrc.org|accessdate=2015-12-11}}</ref> StationaryLDDMM,<ref name="openaire.eu">{{Cite web|title=Publication:Comparing algorithms for diffeomorphic registration: Stationary LDDMM and Diffeomorphic Demons|url=https://www.openaire.eu/search/publication?articleId=dedup_wf_001::ea7b28db1d4570e248acdffb6211d98d|website=www.openaire.eu|accessdate=2015-12-11|archive-url=https://web.archive.org/web/20160216022906/https://www.openaire.eu/search/publication?articleId=dedup_wf_001::ea7b28db1d4570e248acdffb6211d98d|archive-date=2016-02-16|url-status=dead}}</ref> FastLDDMM,<ref>{{Cite journal|last1=Zhang|first1=Miaomiao|last2=Fletcher|first2=P. Thomas|s2cid=10334673|date=2015-01-01 |volume=24|pages=249–259|issn=1011-2499|pmid=26221678|title=Finite-Dimensional Lie Algebras for Fast Diffeomorphic Image Registration|journal=Information Processing in Medical Imaging : Proceedings of the ... Conference|doi=10.1007/978-3-319-19992-4_19|series=Lecture Notes in Computer Science|isbn=978-3-319-19991-7}}</ref> are examples of actively used computational codes for constructing correspondences between coordinate systems based on sparse features and dense images. [[Voxel-based morphometry]] is an important technology built on many of these principles.

==The deformable template orbit model of computational anatomy==
The model of human anatomy is a deformable template, an orbit of exemplars under group action. Deformable template models have been central to Grenander's Metric Pattern theory, accounting for typicality via templates, and accounting for variability via transformation of the template. An orbit under group action as the representation of the deformable template is a classic formulation from differential geometry.  The space of shapes are denoted <math>m \in \mathcal {M}</math>, with the [[Group action (mathematics)|group]] <nowiki/> <math>(\mathcal{ G}, \circ )</math> with law of composition <math>\circ</math>; the action of the group on shapes is denoted <math>g \cdot m</math>, where the action of the group <math>g \cdot m \in \mathcal{M}, m \in \mathcal {M}</math> is defined to satisfy 
:<math> (g \circ g^\prime) \cdot m=g \cdot (g^\prime \cdot m)\in \mathcal { M} .</math>

The orbit <math> \mathcal{M} </math> of the template becomes the space of all shapes, <math> \mathcal{M} \doteq \{ m=g \cdot m_\mathrm{temp}, g \in \mathcal{G} \}</math>, being homogenous under the action of the elements of <math> \mathcal{G}</math>.

[[File:Medial-temporal-lobe-structures.png|alt=FIgure showing different examples of shapes and forms in computational anatomy from MR imager.|thumb|Figure depicting three medial temporal lobe structures amgydala, entorhinal cortex and hippocampus with fiducial landmarks depicted as well embedded in the MRI background.]]
The orbit model of computational anatomy is an abstract algebra - to be compared to [[linear algebra]]- since the groups act nonlinearly on the shapes. This is a generalization of the classical models of linear algebra, in which the set of finite dimensional <math> {\mathbb R}^n </math> vectors are replaced by the finite-dimensional anatomical submanifolds (points, curves, surfaces and volumes) and images of them, and the <math> n \times n </math> matrices of linear algebra are replaced by coordinate transformations based on linear and affine groups and the more general high-dimensional diffeomorphism groups.

==Shapes and forms==
The central objects are shapes or forms in computational anatomy, one set of examples being the 0,1,2,3-dimensional submanifolds of <math> {\mathbb R}^3 </math>, a second set of examples being images generated via [[medical imaging]] such as via [[magnetic resonance imaging]] (MRI) and [[functional magnetic resonance imaging]]. [[File:Subcortical-MRI-caudate-putamen.png|alt=Figure showing triangualted meshes generated from populations of many segmented MRI brains. Each different surface represents a different shape in shape space.|thumb|Triangulated mesh surfaces depicting subcortical structures amygdala, hippocampus, thalamus, caudate, putamen, ventricles.The shapes are denoted <math>m(u), u \in U\subset {\mathbb R}^1 \rightarrow {\mathbb R}^2</math> represented as triangulated meshes.]] The 0-dimensional manifolds are landmarks or fiducial points; 1-dimensional manifolds are curves such as sulcul and gyral curves in the brain; 2-dimensional manifolds correspond to boundaries of substructures in anatomy such as the subcortical structures of the [[midbrain]] or the gyral surface of the [[neocortex]];  subvolumes correspond to subregions of the human body, the [[heart]], the [[thalamus]], the kidney.

The landmarks <math> X \doteq \{ x_1,\dots,x_n \} \subset {\mathbb R}^3 \in \mathcal{M} </math> are a collections of points with no other structure, delineating important fiducials within human shape and form (see associated landmarked image).
The sub-[[manifold]] shapes such as surfaces <math> X \subset {\mathbb R}^3 \in \mathcal{M} </math> are collections of points modeled as parametrized by a local chart or [[immersion (mathematics)|immersion]] <math> m:U \subset {\mathbb R}^{1,2} \rightarrow {\mathbb R}^3 </math>, <math>m(u), u \in U</math> (see Figure showing shapes as mesh surfaces).
The images such as MR images or DTI images <math>I \in \mathcal{M}</math>, and are dense functions
<math> I(x), x \in X \subset {\mathbb R}^{1,2,3} </math> are scalars, vectors, and matrices (see Figure showing scalar image).

==Groups and group actions==
{{Further|Group actions in computational anatomy}}[[File:T1-weighted-MRI.png|alt=Two-dimensional scalar image depicting a section through a 3D brain at the level of the subcortical structures showing white, gray and CSF matter.|thumb|Showing an MRI section through a 3D brain representing a scalar image <math>I(x), x \in {\mathbb R}^2</math> based on T1-weighting.]][[Group (mathematics)|Group]]s and [[Group action (mathematics)|group actions]] are familiar to the Engineering community with the universal popularization and standardization of [[linear algebra]] as a basic model for analyzing [[signals and systems]] in [[mechanical engineering]], [[electrical engineering]] and [[applied mathematics]]. In linear algebra the matrix groups (matrices with inverses) are the central structure, with group action defined by the usual definition of <math>A</math> as an <math>n\times n</math> matrix, acting on <math>x \in {\mathbb R}^n</math> as <math>n \times 1</math>  vectors; the orbit in linear-algebra is the set of <math>n</math>-vectors given by <math>y=A \cdot x \in {\mathbb R}^n</math>, which is a group action of the matrices through the orbit of <math>{\mathbb R}^n</math>.

The central group in computational anatomy defined on volumes in  <math>{\mathbb R}^3</math> are the [[diffeomorphisms]] <math>\mathcal{G} \doteq Diff</math> which are mappings with 3-components <math>\phi(\cdot)=(\phi_1(\cdot),\phi_2 (\cdot),\phi_3 (\cdot))</math>, law of composition of functions <math> \phi \circ \phi^\prime (\cdot)\doteq \phi (\phi^\prime(\cdot)) </math>, with inverse <math> \phi \circ \phi^{-1}(\cdot)=\phi ( \phi^{-1}(\cdot))=id</math>.

Most popular are scalar images, <math>I(x),x \in {\mathbb R}^3</math>, with action on the right via the inverse.

:<math>
\phi \cdot I(x)=I \circ \phi^{-1} (x), x \in {\mathbb R}^3
</math>.

For sub-[[manifold]]s <math> X \subset {\mathbb R}^3 \in \mathcal{M} </math>, parametrized by a chart or [[immersion (mathematics)|immersion]] <math> m(u), u \in U </math>, the diffeomorphic action the flow of the position

:<math>
\phi \cdot m(u) \doteq \phi\circ m(u), u \in U
</math>.

Several [[group actions in computational anatomy]] have been defined.{{citation needed|date=October 2016}}

==Lagrangian and Eulerian flows for generating diffeomorphisms==
For the study of [[rigid body]] [[kinematics]], the low-dimensional matrix [[Lie groups]] have been the central focus. The matrix groups are low-dimensional mappings, which are diffeomorphisms that provide one-to-one correspondences between coordinate systems, with a smooth inverse. The [[matrix group]] of rotations and scales can be generated via a closed form finite-dimensional matrices which are solution of simple ordinary differential equations with solutions given by the matrix exponential.

For the study of deformable shape in computational anatomy, a more general diffeomorphism group has been the group of choice, which is the infinite dimensional analogue. The high-dimensional differeomorphism groups used in Computational Anatomy are generated via smooth flows  <math> \phi_t,  t \in [0,1] </math> which satisfy the [[Lagrangian and Eulerian specification of the flow field]]s<nowiki/> as first introduced in.,<ref name="Christensen"/><ref name=":14"/><ref name="Christensen 1435–14472">{{Cite journal|last1=Christensen|first1=G. E.|last2=Rabbitt|first2=R. D.|last3=Miller|first3=M. I.|date=1996-10-01|title=Deformable Templates Using Large Deformation Kinematics|journal=Trans. Img. Proc.|volume=5|issue=10|pages=1435–1447|doi=10.1109/83.536892|pmid=18290061|bibcode=1996ITIP....5.1435C}}</ref> satisfying the ordinary differential equation: [[File:Lagrangian flow.png|thumb|Showing the Lagrangian flow of coordinates <math>x \in X</math> with associated vector fields <math>v_t, t \in [0,1]</math> satisfying ordinary differential equation <math>\dot \phi_t=v_t(\phi_t), \phi_0=id</math>.]]
{{NumBlk||<math>
 \frac{d}{dt} \phi_t=v_t \circ \phi_t , \ \phi_0=id \ ; </math>|{{EquationRef|Lagrangian flow}}}}
with <math> v \doteq (v_1,v_2,v_3) </math> the vector fields on <math>  {\mathbb R}^3   </math> termed the [[Lagrangian and Eulerian specification of the flow field|Eulerian]] velocity of the particles at position <math>\phi</math> of the flow. The vector fields are functions in a function space, modelled as a smooth [[Hilbert space|Hilbert]] space of high-dimension, with the Jacobian of the flow <math>  \ D\phi \doteq (\frac{\partial \phi_i}{\partial x_j})   </math> a high-dimensional field in a function space as well, rather than a low-dimensional matrix as in the matrix groups. Flows were first introduced<ref>GE Christensen, RD Rabbitt, MI Miller, Deformable templates using large deformation kinematics, IEEE Trans. Image Process. 1996;5(10):1435-47.</ref><ref>GE Christensen, SC Joshi, MI Miller,
Volumetric transformation of brain anatomy
IEEE Transactions on Medical Imaging, 1997.
</ref> for large deformations in image matching; <math>\dot \phi_t(x)</math> is the instantaneous velocity of particle <math>x</math> at time <math>t</math> .

The inverse  <math> \phi_t^{-1}, t \in [0,1] </math> required for the group is defined on the Eulerian vector-field with [[Advection|advective]] inverse flow{{NumBlk||<math>
\frac{d}{dt} \phi_t^{-1}=- (D \phi_t^{-1}) v_t , \ \phi_0^{-1}=id \ .
</math>|{{EquationRef|Inverse Transport flow}}}}

==The diffeomorphism group of computational anatomy==
The group of diffeomorphisms is very big. To ensure smooth flows of diffeomorphisms avoiding [[Advection#Solving the equation|shock-like solutions]] for the inverse,  the vector fields must be at least 1-time continuously differentiable in space.<ref name=":2">P. Dupuis, U. Grenander, M.I. Miller, Existence of Solutions on Flows of Diffeomorphisms, Quarterly of Applied Math, 1997.
</ref><ref name=":4">A. Trouvé. Action de groupe de dimension infinie et reconnaissance de formes. C R Acad Sci Paris Sér I Math, 321(8):1031–
1034, 1995.</ref> For diffeomorphisms on <math>  {\mathbb R}^3   </math>, vector fields are modelled as elements of the Hilbert space  <math>(V, \|\cdot \|_V )</math> using the [[Sobolev space|Sobolev]] embedding theorems so that each element  has strictly greater than 2 generalized square-integrable spatial derivatives (thus <math>v_i \in H_0^3, i=1,2,3,</math> is sufficient), yielding 1-time continuously differentiable functions.<ref name=":2"/><ref name=":4"/>

The diffeomorphism group are flows with vector fields absolutely integrable in Sobolev norm:{{NumBlk|:|<math>
Diff_V \doteq \{\varphi=\phi_1: \dot \phi_t=v_t \circ \phi_t , \phi_0=id, \int_0^1 \|v_t \|_V dt < \infty \} \ ,
</math>|{{EquationRef|Diffeomorphism Group}}}}
where
<math>  \|v\|_V^2 \doteq \int_X Av\cdot v dx, \ v \in V \ ,
</math> 
with the linear operator <math> A </math> mapping to the dual space <math>A: V \mapsto V^*</math>, with the integral calculated by integration by parts when <math>Av \in V^*</math> is a generalized function  in the dual space.

{{Hide|Sobolev smoothness and Reproducing Kernel Hilbert Space with Green's kernel|

===The Sobolev smoothness condition on vector fields as modeled in a reproducing kernel Hilbert space===

The modelling approach used in computational anatomy enforces a continuous differentiability condition on the vector fields by modelling the space of vector fields <math>(V, \|\cdot \|_V )</math> as a [[reproducing kernel Hilbert space]] (RKHS), with the norm defined by a 1-1, differential operator<math> A: V \rightarrow V^*  </math>, Green's inverse <math>K=A^{-1}</math>.  The norm of the Hilbert space is induced by the differential operator.  For <math> \sigma(v) \doteq Av \in V^*
</math> a generalized function or distribution, define the linear form as <math> (\sigma|w)\doteq \int_{{\mathbb R}^3}  \sum_i w_i(x) \sigma_i(dx)
</math>. This determines the norm on <math>(V, \|\cdot \|_V )</math> according to
:<math> \langle v , w \rangle_V \doteq \int_X A v \cdot w dx, \ \|v\|_V^2 \doteq \int_X Av \cdot v dx, \ v,w \in V \ .
</math>
Since <math> A </math> is a differential operator, finiteness of the norm-square <math>  (Av|v) < \infty
</math> includes derivatives from the differential operator implying smoothness of the vector fields.The [[Sobolev embedding]] theorem arguments were made in<ref name=":2" /><ref name=":4" /> demonstrating that 1-continuous derivative is required for smooth flows.
For proper choice of <math>A</math> then <math> (V,\|\cdot \|_V) </math> is an RKHS with the operator <math> K=A^{-1}: V^* \rightarrow V </math>  termed the [[Green's function for the three-variable Laplace equation|Green's]] operator generated from the [[Green's function]] (scalar case) for the vector field case. The Green's kernels associated to the differential operator smooths since the kernel  <math> k(\cdot,\cdot)
</math> is continuously differentiable in both variables implying

:<math> K\sigma (x)_i \doteq \sum_j \int_{{\mathbb R}^3}  k_{ij}(x,y) \sigma_j(dy)
</math> 
When <math> \sigma \doteq \mu dx </math>, a vector density, <math>(\sigma|v) \doteq \int v \cdot \mu dx</math>.
}}

==Diffeomorphometry: The metric space of shapes and forms==
{{Further|Diffeomorphometry}}

The study of metrics on groups of diffeomorphisms and the study of metrics between manifolds and surfaces has been an area of significant investigation.<ref name=":8" /><ref>{{Cite journal|title=Computable Elastic Distances Between Shapes|journal=SIAM Journal on Applied Mathematics|date=1998-04-01|pages=565–586|volume=58|issue=2|doi=10.1137/S0036139995287685|first=L.|last=Younes|citeseerx=10.1.1.45.503}}</ref><ref>{{Cite journal|title=On Shape of Plane Elastic Curves|journal=International Journal of Computer Vision|date=2006-09-25|pages=307–324|volume=73|issue=3|doi=10.1007/s11263-006-9968-0|first1=Washington|last1=Mio|first2=Anuj|last2=Srivastava|first3=Shantanu|last3=Joshi|citeseerx=10.1.1.138.2219|s2cid=15202271}}</ref><ref>{{Cite journal|title=A Metric on Shape Space with Explicit Geodesics|journal=Rend. Lincei Mat. Appl.|volume=9|issue=2008|pages=25–57|arxiv=0706.4299|year=2008|first1=Peter W.|last1=Michor|first2=David|last2=Mumford|first3=Jayant|last3=Shah|first4=Laurent|last4=Younes|bibcode=2007arXiv0706.4299M }}</ref><ref>{{Cite journal|title=An overview of the Riemannian metrics on spaces of curves using the Hamiltonian approach|arxiv=math/0605009|journal=Applied and Computational Harmonic Analysis|pages=74–113|volume=23|issue=1|doi=10.1016/j.acha.2006.07.004|first1=Peter W.|last1=Michor|first2=David|last2=Mumford|year=2007|s2cid=732281}}</ref><ref>{{Cite journal|title=Elastic geodesic paths in shape space of parameterized surfaces|journal=IEEE Transactions on Pattern Analysis and Machine Intelligence|date=2012-09-01|pmid=22144521|pages=1717–1730|volume=34|issue=9|doi=10.1109/TPAMI.2011.233|first1=Sebastian|last1=Kurtek|first2=Eric|last2=Klassen|first3=John C.|last3=Gore|first4=Zhaohua|last4=Ding|first5=Anuj|last5=Srivastava|s2cid=7178535}}</ref> The diffeomorphometry metric measures how close and far two shapes or images are from each other; the metric length is the shortest length of the flow which carries one coordinate system into the other.

Oftentimes, the familiar Euclidean metric is not directly applicable because the patterns of shapes and images don't form a vector space. In the [[Riemannian Metric and Lie-Bracket Interpretation of the Euler Equation on Geodesics|Riemannian orbit model of computational anatomy]], diffeomorphisms acting on the forms <math>\phi \cdot m \in \mathcal {M}, \phi \in Diff_V, m \in \mathcal{M}</math> don't act linearly. There are many ways to define metrics, and for the sets associated to shapes the [[Hausdorff metric]] is another. The method we use to induce the [[Riemannian metric]] is<nowiki/> used to induce the metric on the orbit of shapes by defining it in terms of the metric length between diffeomorphic coordinate system transformations of the flows. Measuring the lengths of the geodesic flow between coordinates systems in the orbit of shapes is called '''diffeomorphometry'''.

===The right-invariant metric on diffeomorphisms===
Define the distance on the group of diffeomorphisms   {{NumBlk||<math>
d_{Diff_V}(\psi, \varphi)=\inf_{v_t} \left(\int_0^1 \int_X Av_t \cdot v_t dx \ dt: \phi_0=\psi, \phi_1=\varphi, \dot \phi_t=v_t \circ \phi_t \right)^{1/2} \ ;
</math>|{{EquationRef|metric-diffeomorphisms}}}}

this is the right-invariant metric of diffeomorphometry,<ref name="Miller 36" /><ref name=":8"/> invariant to reparameterization of space since for all <math> \phi \in Diff_V </math>, 
:<math> d_{Diff_V}(\psi, \varphi)=d_{Diff_V}(\psi \circ \phi, \varphi \circ \phi)</math>.

===The metric on shapes and forms===
The distance on shapes and forms,<ref name="Miller null2"/><math> d_{\mathcal{M}}:\mathcal{M}  \times \mathcal{M}\rightarrow \R^+ </math>, {{NumBlk||<math>
d_{\mathcal{M}}(m,n)=\inf_{\phi \in \operatorname{Diff}_V: \phi \cdot m=n } d_{\operatorname{Diff}_V}(id,\phi) \ ;
</math>|{{EquationRef|metric-shapes-forms}}}}
the images<ref name=":8" />  are denoted with the orbit as  <math>I \in \mathcal{I}</math> and metric <math> , d_{\mathcal{I}} </math>.

==The action integral for Hamilton's principle on diffeomorphic flows==

In classical mechanics the evolution of physical systems is described by solutions to the Euler–Lagrange equations associated to the [[Least-action principle]] of [[Hamilton's principle|Hamilton]]. This is a standard way, for example of obtaining [[Newton's laws of motion]] of free particles. More generally, the Euler-Lagrange equations can be derived for systems of [[generalized coordinates]]. The Euler-Lagrange equation in computational anatomy describes the geodesic shortest path flows between coordinate systems of the diffeomorphism metric. In computational anatomy the generalized coordinates are the flow of the diffeomorphism and its Lagrangian velocity <math>\phi, \dot{\phi}</math>, the two related via the Eulerian velocity <math>v \doteq \dot{\phi} \circ \phi^{-1}</math>. 
[[Hamilton principle|Hamilton's principle]] for generating the Euler-Lagrange equation requires the action integral on the Lagrangian given by 
{{NumBlk|::|<math>J(\phi) \doteq \int_0^1 L(\phi_t,\dot \phi_t) dt \ ;</math>|{{EquationRef|Hamiltonian-Integrated-Lagrangian}}}}
the Lagrangian is given by the kinetic energy:{{NumBlk|:|<math> 
 L(\phi_t, \dot \phi_t ) \doteq \frac{1}{2} \int_X A (\dot \phi_t \circ \phi_t^{-1}) \cdot (\dot \phi_t \circ \phi_t^{-1} ) dx
=\frac{1}{2} \int_X Av_t \cdot v_t \ dx \ .
</math>|{{EquationRef|Lagrangian-Kinetic-Energy}}}}

==Diffeomorphic or Eulerian shape momentum==
In computational anatomy, <math>Av</math> was first called the '''Eulerian or diffeomorphic shape momentum'''<ref>{{Cite journal|last1=MILLER|first1=MICHAEL I.|last2=TROUVÉ|first2=ALAIN|last3=YOUNES|first3=LAURENT|date=2006-01-31|title=Geodesic Shooting for Computational Anatomy|journal=Journal of Mathematical Imaging and Vision|volume=24|issue=2|pages=209–228|doi=10.1007/s10851-005-3624-0|pmc=2897162|pmid=20613972}}</ref>  since when integrated against Eulerian velocity <math>v</math> gives energy density, and since there is a [[#Conservation laws on diffeomorphic shape momentum for computational anatomy|conservation of diffeomorphic shape momentum]] which holds. The operator <math>A</math> is the generalized [[moment of inertia]] or inertial operator.

==The Euler–Lagrange equation on shape momentum for geodesics on the group of diffeomorphisms==
{{Further|Riemannian metric and Lie-bracket in computational anatomy}}

Classical calculation of the Euler-Lagrange equation from [[Hamilton principle|Hamilton's principle]] requires the perturbation of the Lagrangian on the vector field in the kinetic energy with respect to first order perturbation of the flow. This requires adjustment by the [[Lie bracket of vector fields|Lie bracket of vector field]], given by operator <math> ad_v: w \in V \mapsto V </math>  which involves the Jacobian given by 
:<math> ad_v[w]\doteq [v,w]\doteq (Dv)w-(Dw)v \in V </math>.

Defining the adjoint <math> ad_v^*: V^* \rightarrow V^*,  </math> then the first order variation gives the Eulerian shape momentum <math>Av \in V^*</math> satisfying the generalized equation:
{{NumBlk|:|<math> \frac{d}{dt} Av_t + ad_{v_t}^* (Av_t)=0  \ , \ t \in [0,1] \  ;
</math>|{{EquationRef|EL-General}}}}

meaning for all smooth <math> w \in V ,</math>
:<math> \int_X \left( \frac{d}{dt} Av_t + ad_{v_t}^* (Av_t) \right) \cdot w dx=\int_X \frac{d}{dt} Av_t \cdot  w dx + \int_X Av_t \cdot ((Dv_t)w-(Dw)v_t) dx=0 . </math>

Computational anatomy is the study of the motions of submanifolds, points, curves, surfaces and volumes.
Momentum associated to points, curves and surfaces are all singular, implying the momentum is concentrated on subsets of <math> {\mathbb R}^3 </math> which are dimension <math> \leq 2 </math> in [[Lebesgue measure]]. In such cases, the energy is still well defined <math> (Av_t\mid v_t) </math> since although <math> Av_t </math> is a generalized function, the vector fields are smooth and the Eulerian momentum is understood via its action on smooth functions. The perfect illustration of this is even when it is a superposition of delta-diracs, the velocity of the coordinates in the entire volume move smoothly. The Euler-Lagrange equation ({{EquationNote|EL-General}}) on diffeomorphisms for generalized functions <math> Av \in V^* </math> was derived in.<ref name=":0">M.I. Miller, A. Trouve, L. Younes, Geodesic Shooting in Computational Anatomy, IJCV, 2006.</ref> In [[Riemannian Metric and Lie-Bracket Interpretation of the Euler Equation on Geodesics|Riemannian Metric and Lie-Bracket Interpretation of the Euler-Lagrange Equation on Geodesics]] derivations are provided in terms of the adjoint operator and the Lie bracket for the group of diffeomorphisms. It has come to be called EPDiff equation for diffeomorphisms connecting to the Euler-Poincare method having been studied in the context of the inertial operator <math>A=identity</math>  for incompressible, divergence free, fluids.<ref name="Mumford" /><ref name=":3">{{cite journal|last1=Holm|first1=DD|last2=Marsden|first2=JE|last3=Ratiu|first3=TS|year=1998|title=The Euler-Poincaré equations and semidirect products with applications to continuum theories|url=|journal=Adv. Math.|volume=137|issue=|pages=1–81|doi=10.1006/aima.1998.1721|arxiv=chao-dyn/9801015|s2cid=163598}}</ref>

===Diffeomorphic shape momentum: a classical vector function===
For the momentum density case <math> (Av_t \mid w)=\int_X \mu_t \cdot w \, dx </math>, then Euler–Lagrange equation has a classical solution:{{NumBlk|:|

: <math>
 \frac{d}{dt} \mu_t +  (Dv_t)^T \mu_t +(D\mu_t)v_t + ( \nabla \cdot v) \mu_t=0  \ , t \in [0,1].
</math>|{{EquationRef|EL-Classic}}}}The Euler-Lagrange equation on diffeomorphisms, classically defined for momentum densities first appeared in<ref name=":6">{{cite journal|last1=Miller|first1=M.I.|last2=Trouve|first2=A.|last3=Younes|first3=L|year=2002|title=On the Metrics and Euler-Lagrange equations of Computational Anatomy|url=|journal=Annu. Rev. Biomed. Eng.|volume=4|issue=|pages=375–405|doi=10.1146/annurev.bioeng.4.092101.125733|pmid=12117763|citeseerx=10.1.1.157.6533 }}</ref> for medical image analysis.

==Riemannian exponential (geodesic positioning) and Riemannian logarithm (geodesic coordinates)==
{{Further|Riemannian metric and Lie-bracket in computational anatomy}}
In medical imaging and computational anatomy, positioning and coordinatizing shapes are fundamental operations; the system for positioning anatomical coordinates and shapes built on the metric and the Euler-Lagrange equation a geodesic positioning system as first explicated in Miller Trouve and Younes.<ref name="Miller 36"/>
Solving the geodesic from the initial condition <math> v_0 </math> is termed the '''Riemannian-exponential,''' a mapping <math> Exp_{\rm id}(\cdot): V \to Diff_V
</math> at identity to the group.

The Riemannian exponential satisfies <math>
Exp_{id} (v_0)=\phi_1 </math> for initial condition <math>\dot \phi_0=v_0</math>, vector field dynamics <math>\dot \phi_t=v_t \circ \phi_t, t \in [0,1]  
</math>,
* for classical equation diffeomorphic shape momentum <math>\int_X Av_t \cdot w \, dx </math>, <math>Av \in V</math>, then

:<math>
 \ \  \  \frac{d}{dt} Av_t +  (Dv_t)^T Av_t +(DAv_t)v_t + ( \nabla \cdot v) Av_t=0  \ ;
</math>
* for generalized equation, then <math>
Av \in V^* 
</math>,<math> w \in V </math>,
:<math> \ \  \ \int_X \frac{d}{dt} Av_t \cdot  w dx + \int_X Av_t \cdot ((Dv_t)w-(Dw)v_t)dx=0 . </math>

Computing the flow <math> v_0 </math>  onto coordinates '''Riemannian logarithm''',<ref name="Miller 36">{{Cite journal|title=Diffeomorphometry and geodesic positioning systems for human anatomy|journal=Technology|date=2014-03-01|pmc=4041578|pmid=24904924|pages=36–43|volume=2|issue=1|doi=10.1142/S2339547814500010|first1=Michael I.|last1=Miller|first2=Laurent|last2=Younes|first3=Alain|last3=Trouvé}}</ref><ref name="Miller null2" /> mapping <math>Log_{\rm id}(\cdot): Diff_V \to V</math> at identity from <math>\varphi</math> to vector field <math>v_0 \in V</math>;

<math>
  Log_{ id}( \varphi)=v_0 \ \text{initial condition of EL geodesic } \dot \phi_0=v_0, \phi_0=id,  \phi_1=\varphi \ .
</math>

Extended to the entire group they become

<math>
\phi=Exp_\varphi(v_0\circ \varphi) \doteq Exp_{id} (v_0) \circ \varphi
</math> ;   <math>
 Log_\varphi(\phi)\doteq Log_{id}( \phi \circ\varphi^{-1}) \circ \varphi
</math> .

These are inverses of each other for unique solutions of Logarithm; the first is called '''geodesic positioning,''' the latter '''geodesic coordinates''' (see [[Exponential map (Riemannian geometry)|Exponential map, Riemannian geometry]] for the finite dimensional version).'''The geodesic metric''' is a local flattening of the Riemannian coordinate system (see figure). 
[[File:FigBrain.png|thumb|Showing metric local flattening of coordinatized manifolds of shapes and forms. The local metric is given by the norm of the vector field <math>\|v_0\|_V</math> of the geodesic mapping <math>Exp_{id}(v_0) \cdot m</math>]]

==Hamiltonian formulation of computational anatomy==

In computational anatomy the diffeomorphisms are used to push the coordinate systems, and the vector fields are used
as the control within the
anatomical orbit or morphological space. The model is that of a dynamical system, the flow of coordinates <math> t \mapsto \phi_t \in \operatorname{Diff}_V </math> and the control the vector field <math> t \mapsto v_t \in V</math> related via <math> \dot \phi_t=v_t \cdot \phi_t,\phi_0=id . </math>  The Hamiltonian view
<ref name="Miller null2">{{Cite journal|title=Hamiltonian Systems and Optimal Control in Computational Anatomy: 100 Years Since D'arcy Thompson|journal=Annual Review of Biomedical Engineering|date=2015-01-01|volume=17|issue=1|doi=10.1146/annurev-bioeng-071114-040601|first1=Michael I.|last1=Miller|first2=Alain|last2=Trouvé|first3=Laurent|last3=Younes|pages=447–509|pmid=26643025}}</ref>
<ref>Glaunès J, Trouvé A, Younes L. 2006. Modeling planar shape variation via Hamiltonian flows of curves.
In Statistics and Analysis of Shapes, ed. H Krim, A Yezzi Jr, pp. 335–61. Model. Simul. Sci. Eng. Technol.
Boston: Birkhauser
</ref>
<ref>{{cite arxiv|eprint=1401.0661|last1=Micheli|first1=Mario|title=Shape deformation analysis from the optimal control viewpoint|last2=Michor|first2=Peter W.|last3=Mumford|first3=David|last4=Younes|first4=Laurent|class=math.OC|year=2014}}</ref>
<ref>{{cite journal | doi = 10.1142/S2339547814500010 | pmid=24904924 | pmc=4041578 | volume=2 | title=Diffeomorphometry and geodesic positioning systems for human anatomy | year=2014 | journal=Technology (Singap World Sci) | pages=36–43 | last1 = Miller | first1 = MI | last2 = Younes | first2 = L | last3 = Trouvé | first3 = A}}
</ref><ref>{{Cite journal|title=An overview of the Riemannian metrics on spaces of curves using the Hamiltonian approach|journal=Applied and Computational Harmonic Analysis|date=2007-07-01|pages=74–113|volume=23|series=Special Issue on Mathematical Imaging|issue=1|doi=10.1016/j.acha.2006.07.004|first1=Peter W.|last1=Michor|first2=David|last2=Mumford|arxiv=math/0605009|s2cid=732281}}</ref> reparameterizes the momentum distribution <math> Av \in V^* </math> in terms of the '''''conjugate momentum''' or'' '''''canonical momentum''', i''ntroduced as a Lagrange multiplier <math> p: \dot \phi \mapsto (p\mid\dot \phi) </math> constraining the Lagrangian velocity <math> \dot \phi_t=v_t \circ \phi_t</math>.accordingly:
:<math>
H(\phi_t,p_t,v_t)=\int_X p_t \cdot (v_t \circ \phi_t) dx-\frac{1}{2}\int_X Av_t \cdot v_t dx .</math>

This function is the extended Hamiltonian. The [[Pontryagin maximum principle]]<ref name="Miller null2"/> gives the optimizing vector field which determines the geodesic flow satisfying <math>\dot \phi_t=v_t \circ \phi_t , \phi_0=id,</math> as well as the reduced Hamiltonian 
:<math> H(\phi_t,p_t) \doteq \max_v H( \phi_t, p_t,v) \ . </math>
The Lagrange multiplier in its action as a linear form has its own inner product of the canonical momentum acting on the velocity of the flow which is dependent on the shape, e.g. for landmarks a sum, for surfaces a surface integral, and. for volumes it is a volume integral with respect to <math>dx</math> on  <math>{\mathbb R}^3</math>. In all cases the Greens kernels carry weights which are the canonical momentum evolving according to an ordinary differential equation which corresponds to EL but is the geodesic reparameterization in canonical momentum. The optimizing vector field is given by
:<math>v_t \doteq \arg max_{v} H(\phi_t,p_t,v)</math>
with dynamics of canonical momentum reparameterizing the vector field along the geodesic 
{{NumBlk|:|<math>  \begin{cases}
\dot \phi_t=\frac{\partial H( \phi_t, p_t)}{\partial p} \\
\dot p_t=-\frac{\partial H(\phi_t,p_t)}{\partial \phi}
\\
\end{cases}
</math>|{{EquationRef|Hamiltonian-Dynamics}}}}

===Stationarity of the Hamiltonian and kinetic energy along Euler–Lagrange===
Whereas the vector fields are extended across the entire background space of <math>{\mathbb R}^3</math>, the geodesic flows associated to the submanifolds has Eulerian shape momentum which evolves as a generalized function <math>Av_t \in V^*</math> concentrated to the submanifolds. For landmarks<ref name=":5">{{cite journal | last1 = Joshi | first1 = S. | last2 = Miller | first2 = M.I. | year = 2000 | title = Landmark matching via large deformation diffeomorphisms | url = | journal = IEEE Trans. Image Process. | volume = 9 | issue = 8| pages = 1357–70 | doi = 10.1109/83.855431 | pmid = 18262973 | bibcode = 2000ITIP....9.1357J }}</ref><ref name=":10">V. Camion, L. Younes: Geodesic Interpolating Splines (EMMCVPR 2001)
</ref><ref name=":11">J Glaunès, M Vaillant, MI Miller. Landmark matching via large deformation diffeomorphisms on the sphere
 Journal of mathematical imaging and vision, 2004.
</ref>  the [[#Landmark or pointset geodesics|geodesics have Eulerian shape momentum which are a superposition of delta distributions]] travelling with the finite numbers of particles; the diffeomorphic flow of coordinates have velocities in the range of weighted Green's Kernels. For surfaces, the momentum is a [[#Surface geodesics|surface integral of delta distributions]] travelling with the surface.<ref name="Miller 36" />

The geodesics connecting coordinate systems satisfying {{EquationNote|EL-General}} have stationarity of the Lagrangian. The Hamiltonian is given by the extremum along the path <math>t \in [0,1]</math>, <math>H(\phi,p)=\max_v H(\phi,p,v)
</math>, equalling the {{EquationNote|Lagrangian-Kinetic-Energy}}  and is stationary along {{EquationNote|EL-General}}. Defining the geodesic velocity at the identity <math>v_0=\arg \max_v H(\phi_0,p_0,v)
</math>, then along the geodesic
{{NumBlk|::|<math>H(\phi_t,p_t)=H(\phi_0,p_0)=\frac{1}{2} \int_X p_0 \cdot v_0 dx=\frac{1}{2} \int_X Av_0 \cdot v_0 dx=\frac{1}{2} \int_X Av_t \cdot v_t dx
 </math>|{{EquationRef|Hamiltonian-Geodesics}}}}The stationarity of the Hamiltonian demonstrates the interpretation of the Lagrange multiplier as momentum; integrated against velocity <math>\dot \phi</math> gives energy density. The canonical momentum has many names. In [[optimal control]], the flows <math>\phi</math> is interpreted as the state, and <math>p</math> is interpreted as conjugate state, or conjugate momentum.<ref>{{Cite journal|title=Hamiltonian Systems and Optimal Control in Computational Anatomy: 100 Years Since D'Arcy Thompson|journal=Annual Review of Biomedical Engineering|date=2015-01-01|pmid=26643025|pages=447–509|volume=17|issue=1|doi=10.1146/annurev-bioeng-071114-040601|first1=Michael I.|last1=Miller|first2=Alain|last2=Trouvé|first3=Laurent|last3=Younes}}</ref> The geodesi of EL implies specification of the vector fields <math>v_0</math> or Eulerian momentum <math>Av_0</math> at <math>t=0</math>, or specification of canonical momentum <math>p_0</math> determines the flow.

==The metric on geodesic flows of landmarks, surfaces, and volumes within the orbit==
In computational anatomy the submanifolds are pointsets, curves, surfaces and subvolumes which are the basic primitives. The geodesic flows between the submanifolds determine the distance, and form the basic measuring and transporting tools of [[diffeomorphometry]]. At  <math>t=0</math> the geodesic has vector field <math>v_0=K p_0</math> determined by the conjugate momentum and the Green's kernel of the inertial operator defining the Eulerian momentum <math>K=A^{-1}</math>. The metric distance between coordinate systems connected via the geodesic determined by the induced distance between identity and group element:
:<math>d_{Diff_V}(id,\varphi)=\|Log_{id}(\varphi)\|_V=\|v_0 \|_V=\sqrt{2H(id,p_0)}</math>

==[[Conservation law (physics)|Conservation law]]s on diffeomorphic shape momentum for computational anatomy==
Given the least-action there is a natural definition of momentum associated to generalized coordinates; the quantity acting against velocity gives energy. The field has studied two forms, the momentum associated to the Eulerian vector field termed '''Eulerian diffeomorphic shape momentum''', and the momentum associated to the initial coordinates or canonical coordinates termed '''canonical diffeomorphic shape momentum'''. Each has a conservation law. The conservation of momentum goes hand in hand with the {{EquationNote|EL-General}}. In computational anatomy, <math>Av</math> is the Eulerian [[Momentum]] since when integrated against Eulerian velocity <math>v</math> gives energy density; operator <math>A</math> the generalized [[moment of inertia]] or inertial operator which acting on the Eulerian velocity gives momentum which is conserved along the geodesic: {{NumBlk|:|
<math>
\begin{matrix}
\text{Eulerian} & \ \ \ \  
\frac{d}{dt} \int_X Av_t \cdot ((D \phi_t) w) \circ \phi_t^{-1})dx=0 \ , \ t \in [0,1] .
\\
&
\\
\text{Canonical} & \ \ \ \   \ \ \ \ \ \ \ 
\frac{d}{dt} \int_X p_t \cdot ( (D\phi_t) w) dx=0 \ , \ t \in [0,1] \ \text{ for all} \ w \in V \ .
\end{matrix}
</math>|{{EquationRef|Euler-Conservation-Constant-Energy}}}}

Conservation of Eulerian shape momentum was shown in<ref name=":7">{{Cite journal|title=Geodesic Shooting for Computational Anatomy|journal=Journal of Mathematical Imaging and Vision|date=2006-01-31|pmc=2897162|pmid=20613972|pages=209–228|volume=24|issue=2|doi=10.1007/s10851-005-3624-0|first1=MICHAEL I.|last1=MILLER|first2=ALAIN|last2=TROUVÉ|first3=LAURENT|last3=YOUNES}}</ref> and follows from {{EquationNote|EL-General}}; conservation of canonical momentum was shown in<ref name="Miller null2"/>
{{hidden 
|Proof of conservation
|The proof follow from defining <math>w_t=((D \phi_t) w) \circ \phi_t^{-1}</math>, <math>\frac{d}{dt} w_t=(Dv_t) w_t - (D w_t) v_t</math> implying
<math>\frac{d}{dt} (Av_t|((D \phi_t) w) \circ \phi_t^{-1})=(\frac{d}{dt}Av_t|((D \phi_t) w) \circ \phi_t^{-1})+(Av_t|\frac{d}{dt} ((D \phi_t) w) \circ \phi_t^{-1})=(\frac{d}{dt} Av_t|w_t )+(Av_t|(D v_t) w_t-(Dw_t)v_t)=0.</math>

The proof on Canonical momentum is shown from <math>\dot p_t=- (Dv_t)_{|_{\phi_t}}^T p_t</math>: 
: <math>\frac{d}{dt} (p_t|(D\phi_t) w)=(\dot p_t|(D\phi_t) w)+(p_t|\frac{d}{dt} (D\phi_t) w)
=(\dot p_t|(D \phi_t) w)+(p_t|(Dv_t)_{|_{\phi_t} }(D \phi_t) w)=0</math>.
}}

==Geodesic interpolation of information between coordinate systems via variational problems==
{{Further|Large deformation diffeomorphic metric mapping}}
Construction of diffeomorphic correspondences between shapes calculates the initial vector field coordinates <math>v_0 \in V</math> and associated weights on the Greens kernels <math>p_0</math>. These initial coordinates are determined by matching of shapes, called '''[[Large deformation diffeomorphic metric mapping|Large Deformation Diffeomorphic Metric Mapping (LDDMM)]].''' LDDMM has been solved for landmarks with and without correspondence<ref name="Joshi 1357–1370" /><ref>{{Cite book|title=Geodesic Interpolating Splines|url=http://dl.acm.org/citation.cfm?id=646596.756898|journal=Proceedings of the Third International Workshop on Energy Minimization Methods in Computer Vision and Pattern Recognition|date=2001-01-01|isbn=978-3-540-42523-6|pages=513–527|series=EMMCVPR '01|first1=Vincent|last1=Camion|first2=Laurent|last2=Younes|doi = 10.1007/3-540-44745-8_34}}</ref><ref>{{Cite journal|title=Statistics on diffeomorphisms via tangent space representations|journal=NeuroImage|date=2004-01-01|pmid=15501085|pages=S161–169|volume=23 Suppl 1|doi=10.1016/j.neuroimage.2004.07.023|first1=M.|last1=Vaillant|first2=M. I.|last2=Miller|first3=L.|last3=Younes|first4=A.|last4=Trouvé|citeseerx=10.1.1.132.6802|s2cid=8255538}}</ref><ref>{{Cite journal |date=2007-01-01|pmid=17633716|pages=396–407|volume=20|first1=Stephen|last1=Marsland|first2=Robert|last2=McLachlan|title=A hamiltonian particle method for diffeomorphic image registration|journal=Information Processing in Medical Imaging : Proceedings of the ... Conference|doi=10.1007/978-3-540-73273-0_33|series=Lecture Notes in Computer Science|isbn=978-3-540-73272-3}}</ref><ref>{{Cite book|title=L.: Diffeomorphic matching of distributions: A new approach for unlabelled point-sets and sub-manifolds matching|volume=2|pages=712–718|chapter-url=https://www.researchgate.net/publication/4082354|website=ResearchGate|accessdate=2015-11-25|doi=10.1109/CVPR.2004.1315234|chapter=Diffeomorphic matching of distributions: A new approach for unlabelled point-sets and sub-manifolds matching|year=2004|last1=Glaunes|first1=J|last2=Trouve|first2=A|last3=Younes|first3=L|isbn=978-0-7695-2158-9|citeseerx=10.1.1.158.4209}}</ref> and for dense image matchings.<ref name=":13">{{Cite journal|title=Computing Large Deformation Metric Mappings via Geodesic Flows of Diffeomorphisms|journal=International Journal of Computer Vision|date=2005-02-01|pages=139–157|volume=61|issue=2|doi=10.1023/B:VISI.0000043755.93987.aa|first1=M. Faisal|last1=Beg|first2=Michael I.|last2=Miller|first3=Alain|last3=Trouvé|first4=Laurent|last4=Younes|s2cid=17772076}}</ref><ref name=":12"/> curves,<ref>{{Cite journal|title=Large Deformation Diffeomorphic Metric Curve Mapping|journal=International Journal of Computer Vision|date=2008-12-01|pmc=2858418|pmid=20419045|pages=317–336|volume=80|issue=3|doi=10.1007/s11263-008-0141-9|first1=Joan|last1=Glaunès|first2=Anqi|last2=Qiu|first3=Michael I.|last3=Miller|first4=Laurent|last4=Younes}}</ref> surfaces,<ref name="Vaillant 1149–1159" /><ref>{{Cite journal|title=Surface matching via currents|journal=Proceedings of Information Processing in Medical Imaging (IPMI 2005), Number 3565 in Lecture Notes in Computer Science|date=2005-01-01|pages=381–392|first1=Marc|last1=Vaillant|first2=Joan|last2=Glaunès|volume=19|citeseerx=10.1.1.88.4666|pmid=17354711|doi=10.1007/11505730_32|isbn=978-3-540-26545-0|series=Lecture Notes in Computer Science}}</ref> dense vector<ref>{{Cite book|title=Large deformation diffeomorphic metric mapping of fiber orientations|journal=Tenth IEEE International Conference on Computer Vision, 2005. ICCV 2005|date=2005-10-01|pages=1379–1386 Vol. 2|volume=2|doi=10.1109/ICCV.2005.132|first1=Yan|last1=Cao|first2=M.I.|last2=Miller|first3=R.L.|last3=Winslow|first4=L.|last4=Younes|isbn=978-0-7695-2334-7|citeseerx=10.1.1.158.1582|s2cid=13019795}}</ref> and tensor<ref name="Cao 1216–1230">{{Cite journal|title=Large deformation diffeomorphic metric mapping of vector fields|journal=IEEE Transactions on Medical Imaging|date=2005-09-01|pmid=16156359|pages=1216–1230|volume=24|issue=9|doi=10.1109/TMI.2005.853923|first1=Yan|last1=Cao|first2=M.I.|last2=Miller|first3=R.L.|last3=Winslow|first4=L.|last4=Younes|citeseerx=10.1.1.157.8377|s2cid=7046743}}</ref> imagery, and varifolds removing orientation.<ref>{{Cite journal|title=The Varifold Representation of Nonoriented Shapes for Diffeomorphic Registration|journal=SIAM Journal on Imaging Sciences|date=2013-01-01|pages=2547–2580|volume=6|issue=4|doi=10.1137/130918885|first1=N.|last1=Charon|first2=A.|last2=Trouvé|arxiv=1304.6108|bibcode=2013arXiv1304.6108C|s2cid=14335966}}</ref> LDDMM calculates geodesic flows of the {{EquationNote|EL-General}} onto target coordinates, adding to the action integral <math>\frac{1}{2} \int_0^1 \int_X Av_t\cdot v_t dx dt</math> an endpoint matching condition <math>E: \phi_1 \rightarrow R^+</math> measuring the correspondence of elements in the orbit under coordinate system transformation. Existence of solutions were examined for image matching.<ref name=":142"/> The solution of the variational problem satisfies the {{EquationNote|EL-General}} for <math>t \in [0,1)</math> with boundary condition.

===Matching based on minimizing kinetic energy action with endpoint condition===

<math>\text{min}_{\phi:v=\dot \phi \circ \phi^{-1}, \phi_0=id} C(\phi) \doteq \frac{1}{2} \int_0^1 \int_X Av_t \cdot v_t dx dt +E( \phi_1)
</math>

<math>
\begin{cases}
\text{Euler Conservation} \ \ \ \  \ \ \ \  &  \ \ \  \frac{d}{dt} Av_t + ad_{v_t}^* (Av_t)=0  , \  t \in [0,1) \ ,
\\
\text{Boundary Condition}  &  \ \ \ \phi_0=id,  Av_1=- \frac{\partial E(\phi)}{\partial \phi}|_{\phi=\phi_1} \ .
\end{cases}
</math>

Conservation from {{EquationNote|EL-General}} extends the B.C. at <math>t=1</math> to the rest of the path <math>
t \in [0,1)
</math>. The inexact matching problem with the endpoint matching term <math>E(\phi_1)</math> has several alternative forms. One of the key ideas of the stationarity of the Hamiltonian along the geodesic solution is the integrated running cost reduces to initial cost at t=0, geodesics of the {{EquationNote|EL-General}} are determined by their initial condition <math>v_0</math>.

The running cost is reduced to the initial cost determined by <math>v_0=Kp_0</math> of  {{EquationNote|Kernel-Surf.-Land.-Geodesics}}.

===Matching based on geodesic shooting===

:<math>\min_{v_0} C(v_0) \doteq \frac{1}{2} \int_X Av_0 \cdot v_0 dx
   +E(\mathrm{Exp}_\mathrm{id}(v_0) \cdot I_0) \ ;
</math>
:<math>\min_{p_0} C(p_0)=
   \frac{1}{2}\int_X p_0 \cdot Kp_0 dx+ E(\mathrm{Exp}_\text{id}(Kp_0) \cdot I_0)
   </math>
The matching problem explicitly indexed to initial condition <math>v_0</math> is called shooting, which can also be reparamerized via the conjugate momentum <math>p_0</math>.

==Dense image matching in computational anatomy==
{{Further|LDDMM|Large deformation diffeomorphic metric mapping#The variational problem of dense image matching}}
Dense image matching has a long history now with the earliest efforts<ref>{{Cite journal|title=A computerized system for the elastic matching of deformed radiographic images to idealized atlas images|journal=Journal of Computer Assisted Tomography|date=1983-08-01|pmid=6602820|pages=618–625|volume=7|issue=4|first1=R.|last1=Bajcsy|first2=R.|last2=Lieberson|first3=M.|last3=Reivich|doi=10.1097/00004728-198308000-00008}}</ref><ref>{{Cite journal|title=Structural Image Restoration through Deformable Templates|journal=Journal of the American Statistical Association|date=1991-06-01|pages=376–387|volume=86|issue=414|doi=10.1080/01621459.1991.10475053|first1=Yali|last1=Amit|first2=Ulf|last2=Grenander|first3=Mauro|last3=Piccioni}}</ref> exploiting a small deformation framework. Large deformations began in the early 1990s,<ref name="Christensen 1435–1447"/><ref name=":14"/> with the first existence to solutions to the variational problem for flows of diffeomorphisms for dense image matching established in.<ref name=":142"/> Beg solved via one of the earliest LDDMM algorithms based on solving the variational matching with endpoint defined by the dense imagery with respect to the vector fields, taking variations with respect to the vector fields.<ref name=":13"/> Another solution for dense image matching reparameterizes the optimization problem in terms of the state <math>q_t \doteq I \circ \phi_t^{-1}, q_0=I</math> giving the solution in terms of the infinitesimal action defined by the [[advection]] equation.<ref name="Miller 36"/><ref name="Miller 447–509"/><ref name=":12">{{Cite journal|title=Diffeomorphic 3D Image Registration via Geodesic Shooting Using an Efficient Adjoint Calculation|journal=Int. J. Comput. Vis.|date=2012-04-01|pages=229–241|volume=97|issue=2|doi=10.1007/s11263-011-0481-8|first1=François-Xavier|last1=Vialard|first2=Laurent|last2=Risser|first3=Daniel|last3=Rueckert|first4=Colin J.|last4=Cotter|s2cid=18251140}}</ref>

===[[LDDMM]] dense image matching===
{{Further|Large Deformation Diffeomorphic Metric Mapping#Beg's LDDMM algorithm for image matching}}
For Beg's LDDMM, denote the Image <math> I(x), x \in X </math> with group action <math> \phi \cdot I \doteq I \circ \phi^{-1} </math>. 
Viewing this as an optimal control problem, the state of the system is the diffeomorphic flow of coordinates <math> \phi_t, t \in [0,1] </math>, with the dynamics relating the control <math>v_t, t \in [0,1]</math> to the state given by <math>\dot \phi=v \circ \phi</math>. The endpoint matching condition <math>E(\phi_1) \doteq \|I\circ \phi_1^{-1} -I^\prime\|^2</math> gives the variational problem

{{NumBlk|:|
<math>
\begin{matrix}
& \ \  \ \ \  \min_{v:  \dot \phi=v \circ \phi} C(v) \doteq \frac{1}{2} \int_0^1
     \int_X Av_t \cdot v_t dx dt  +\frac{1}{2} \int_{{\mathbb R}^3}|I\circ \phi_1^{-1}(x)-I^\prime (x)|^2dx
\end{matrix}
</math>|{{EquationRef|Dense-Image-Matching}}}}
:<math>
\begin{cases}
& \text{Endpoint Condition:} \  \ \ \ \ \  Av_1=\mu_1 dx, \mu_1=(I\circ \phi_1^{-1}-I^\prime ) \nabla (I \circ \phi_1^{-1})  \ ,\\
&\text{Conservation:} \ \ \ \ \ \ \ \ \ \ \ \ \  \ \ Av_t=\mu_t \, dx, \ \mu_t=(D \phi_t^{-1})^T \mu_0 \circ \phi_t^{-1}|D \phi_t^{-1}|\ . \\
& \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mu_0=(I - I^\prime \circ \phi_1) \nabla I|D \phi_1|\ . \\
\end{cases}
</math>
Beg's iterative [[large deformation diffeomorphic metric mapping#Beg's Iterative LDDMM Algorithm|LDDMM algorithm]] has fixed points which satisfy the necessary optimizer conditions. The iterative algorithm is given in [[LDDMM#Beg's LDDMM algorithm for image matching|Beg's LDDMM algorithm for dense image matching]].

===Hamiltonian LDDMM in the reduced advected state===
{{Further|Large Deformation Diffeomorphic Metric Mapping#Hamiltonian LDDMM for Dense Image Matching}}
Denote the Image <math> I(x), x \in X </math>, with state <math>q_t \doteq I \circ \phi_t^{-1}</math> and the dynamics related state and control given by the [[Advection|advective term]] <math>\dot q_t=- \nabla q_t \cdot v_t</math>. The endpoint <math>
E(q_1) \doteq \|q_1-I^\prime\|^2 
</math> gives the variational problem
{{NumBlk|::|
<math>
\begin{matrix}
& \ \  \ \ \  \min_{q:   \dot q=v \circ q} C(v) \doteq \frac{1}{2} \int_0^1
     \int_X Av_t \cdot v_t dx dt  +\frac{1}{2} \int_{{\mathbb R}^3}|q_1(x)-I^\prime(x)|^2dx
\end{matrix}
</math>|{{EquationRef|Dense-Image-Matching}}}}
Viallard's iterative [[Large deformation diffeomorphic metric mapping#Hamiltonian LDDMM for Dense Image Matching|Hamiltonian LDDMM]] has fixed points which satisfy the necessary optimizer conditions.

===Diffusion tensor image matching in computational anatomy===
{{Further|Group actions in computational anatomy|LDDMM}}
[[File:Dti-MRI-brain-section.png|alt=Image shows colored picture demonstrating orientations of fibers based on principle eigenvectors and eigenvalues of DTI matrices.|thumb|Image showing a diffusion tensor image with three color levels depicting the orientations of the three eigenvectors of the matrix image <math>I(x), x \in {\mathbb R}^2</math>, matrix valued image; each of three colors represents a direction.]]
Dense LDDMM tensor matching<ref name="Cao 1216–1230"/><ref>{{Cite book|title=Diffeomorphic Matching of Diffusion Tensor Images|journal=Conference on Computer Vision and Pattern Recognition Workshop, 2006. CVPRW '06|date=2006-06-01|pmc=2920614|pmid=20711423|pages=67|doi=10.1109/CVPRW.2006.65|first1=Yan|last1=Cao|first2=M.I.|last2=Miller|first3=Susumu|last3=Mori|first4=R.L.|last4=Winslow|first5=L.|last5=Younes|volume=2006|isbn=978-0-7695-2646-1}}</ref> takes the images as 3x1 vectors and 3x3 tensors solving the variational problem matching between coordinate system based on the principle eigenvectors of the [[Diffusion MRI|diffusion tensor MRI]] image (DTI) denoted <math>M(x), x \in {\mathbb R}^3</math> consisting of the <math>3 \times 3</math>-tensor at every voxel. Several of the group actions defined based on the Frobenius [[matrix norm]] between square matrices <math>\|A \|_F^2 \doteq trace A^T A</math> . Shown in the accompanying figure is a DTI image illustrated via its color map depicting the eigenvector orientations of the DTI matrix at each voxel with color determined by the orientation of the directions.
Denote the <math>3 \times 3</math> tensor image <math>M(x), x \in {\mathbb R}^3</math> with eigen-elements <math>\{\lambda_i(x), e_i(x), i=1,2,3\}</math>, <math>\lambda_1 \geq  \lambda_2 \geq \lambda_3 </math>.

Coordinate system transformation based on DTI imaging has exploited two actions 
[[Group actions in computational anatomy#Tensor matrices|one based on the principle eigen-vector or entire matrix]].

LDDMM matching based on the principal eigenvector of the diffusion tensor matrix
takes the image <math> I(x), x \in {\mathbb R}^3 </math> as a unit vector field defined by the first eigenvector. The group action becomes
:<math>
\varphi \cdot I=
\begin{cases}
\frac{D_{\varphi^{-1}} \varphi I \circ \varphi^{-1} \|I \circ \varphi^{-1}\|}{\|D_{\varphi^{-1}} \varphi I \circ \varphi^{-1}\|} & I\circ \varphi \neq 0; \\
0 & \text{otherwise.}
\end{cases}
</math>

LDDMM matching based on the entire tensor matrix
has group action becomes <math>\varphi \cdot M=(\lambda_1 \hat{e}_1 \hat{e}_1^{T}+\lambda_2 \hat{e}_2 \hat{e}_2^{T} +\lambda_3 \hat{e}_3 \hat{e}_3^{T}) \circ \varphi^{-1} , </math> transformed eigenvectors
:<math>\begin{align}
 \hat{e}_1 &=\frac{D \varphi e_1}{\|D \varphi e_1\|} \ , \  \ \ 
\hat{e}_2=\frac{D \varphi e_2-\langle \hat{e}_1,D \varphi e_2\rangle \hat{e}_1}{\sqrt{\|D \varphi e_2\|^2-\langle \hat{e}_1,D \varphi e_2\rangle^2}}\ , \ \ \ 
\hat{e}_3=\hat{e}_1 \times \hat{e}_2
\end{align}</math>.

The variational problem matching onto the principal eigenvector or the matrix is described
[[Large deformation diffeomorphic metric mapping#LDDMM Diffusion Tensor Image Matching|LDDMM Tensor Image Matching]].

===High Angular Resolution Diffusion Image (HARDI) matching in computational anatomy===
{{Further|Group actions in computational anatomy|LDDMM#LDDMM ODF}}

High angular resolution diffusion imaging (HARDI) addresses the well-known limitation of DTI, that is, DTI can only reveal one dominant fiber orientation at each location. HARDI measures diffusion along <math> n </math> uniformly distributed directions on the sphere and can characterize more complex fiber geometries. HARDI can be used to reconstruct an [[orientation distribution function]] (ODF) that characterizes the angular profile of the diffusion probability density function of water molecules. The ODF is a function defined on a unit sphere, <math> {\mathbb{S}}^2 </math>.

Dense LDDMM ODF matching <ref>{{cite journal|last1=Du|first1=J|last2=Goh|first2=A|last3=Qiu|first3=A|title=Diffeomorphic metric mapping of high angular resolution diffusion imaging based on Riemannian structure of orientation distribution functions|journal=IEEE Trans Med Imaging|date=2012|volume=31|issue=5|pages=1021–1033|doi=10.1109/TMI.2011.2178253|pmid=22156979|s2cid=11533837}}</ref> takes the HARDI data as ODF at each voxel and solves the LDDMM variational problem in the space of ODF. In the field of [[information geometry]],<ref>{{cite book|last1=Amari|first1=S|title=Differential-Geometrical Methods in Statistics|date=1985|publisher=Springer}}</ref> the space of ODF forms a Riemannian manifold with the Fisher-Rao metric. For the purpose of LDDMM ODF mapping, the square-root representation is chosen because it is one of the most efficient representations found to date as the various Riemannian operations, such as geodesics, exponential maps, and logarithm maps, are available in closed form. In the following, denote square-root ODF (<math>{\sqrt{\text{ODF}}} </math>) as <math> \psi({\bf s}) </math>, where <math> \psi({\bf s}) </math> is non-negative to ensure uniqueness and <math> \int_{{\bf s}\in  {\mathbb{S}}^2} \psi^2({\bf s}) d{\bf s}=1</math>. The variational problem for matching assumes that two ODF volumes can be generated from one to another via flows of diffeomorphisms <math> \phi_t </math>, which are solutions of ordinary differential equations <math> \dot \phi_t=v_t (\phi_t), t \in [0,1], </math> starting from the identity map <math>\phi_0={id} </math>. Denote the action of the diffeomorphism on template  as <math>\phi_1 \cdot \psi_{\mathrm{temp}}({\bf s},x)</math>, <math> {\bf s} \in {{\mathbb{S}}^2} </math>, <math> x \in X </math> are respectively the coordinates of the unit sphere, <math> {{\mathbb{S}}^2} </math> and the image domain, with the target indexed similarly, <math>\psi_{\mathrm{targ}}({\bf s}, x)</math>,<math> {\bf s} \in {{\mathbb{S}}^2} </math>,<math> x \in X </math>.

The group action of the diffeomorphism on the template is given according to
:<math>\phi_1 \cdot \psi (x)\doteq  (D\phi_1) \psi \circ \phi_1^{-1}(x), x \in X </math>,
where <math> (D\phi_1) </math> is the Jacobian of the affined transformed ODF and is defined as
<math>
\begin{align}
(D \phi_1) \psi\circ \phi_1^{-1}(x)=\sqrt{\frac{\det{\bigl(D_{\phi_1^{-1}}\phi_1 \bigr)^{-1}} }{\left\|{\bigl(D_{\phi_1^{-1}}\phi_1 \bigr)^{-1} } {\bf s} \right\|^3} } \quad
\psi \left( \frac{(D_{\phi_1^{-1}}\phi_1 \bigr)^{-1} {\bf s}}{\|(D_{\phi_1^{-1}}\phi_1 \bigr)^{-1} {\bf s}\|}, \phi_1^{-1}(x) \right) .
\end{align}
</math>

This group action of diffeomorphisms on ODF reorients the ODF and reflects changes in both the magnitude of <math> \psi </math> and the sampling directions of <math> \bf s </math> due to affine transformation. It guarantees that the volume fraction of fibers oriented toward a small patch must remain the same after the patch is transformed. 

The LDDMM variational problem is defined as
:<math>
\begin{align}
C(v)=\inf_{v: \dot \phi_t=
v_t \circ \phi_t,\phi_0={
id}}\int_0^1 \int_X Av_t \cdot v_t dx \ dt 
 +\lambda \int_{x\in\Omega}\|\log_{(D\phi_1) \psi_{\mathrm{temp}} \circ \phi_1^{-1}(x)}(\psi_{\mathrm{targ}}(x))\|^2_{(D\phi_1) \psi_{\mathrm{temp}}\circ \phi_1^{-1}(x)}dx 
\end{align}
</math>.

where the logarithm of <math> \psi_1, \psi_2 \in \Psi </math> is defined as
:<math>
\begin{align}
\|\log_{\psi_1}(\psi_2)\|_{\psi_1} 
=\cos^{-1} \langle \psi_1, \psi_2 \rangle=
\cos^{-1}\left(\int_{{\bf s}\in {\mathbb{S}}^2} \psi_1({\bf s}) \psi_2({\bf s})d{\bf s}\right),
\end{align}
</math>
where <math> \langle \cdot, \cdot \rangle </math> is the normal dot product between points in the sphere under the <math>\mathrm{L}^2 </math> metric.

This LDDMM-ODF mapping algorithm has been widely used to study brain white matter degeneration in aging, Alzheimer's disease, and vascular dementia.<ref>{{cite journal|last1=Thong|first1=JY|last2=Du|first2=J|last3=Ratnarajah|first3=N|last4=Dong|first4=Y|last5=Soon|first5=HW|last6=Saini|first6=M|last7=Tan|first7=MZ|last8=Ta|first8=AT|last9=Chen|first9=C|last10=Qiu|first10=A|s2cid=15230668|title=Abnormalities of cortical thickness, subcortical shapes, and white matter integrity in subcortical vascular cognitive impairment|journal=Hum. Brain Mapp.|date=2014|volume=35|issue=5|pages=2320–2332|doi=10.1002/hbm.22330|pmid=23861356|pmc=6869364}}</ref> The brain white matter atlas generated based on ODF is constructed via Bayesian estimation.<ref>{{Cite book|last1=DU|first1=J|last2=Goh|first2=A|last3=Qiu|first3=A|s2cid=8571740|title=Bayesian Atlas Estimation from High Angular Resolution Diffusion Imaging (HARDI)|journal=Lecture Notes in Computer Science|date=2013|volume=8085|pages=149–157|doi=10.1007/978-3-642-40020-9_15|isbn=978-3-642-40019-3}}</ref> Regression analysis on ODF is developed in the ODF manifold space in.<ref>{{cite journal|last1=Du|first1=J|last2=Goh|first2=A|last3=Kushnarev|first3=S|last4=Qiu|first4=A|title=Geodesic regression on orientation distribution functions with its application to an aging study|journal=NeuroImage|date=2014|volume=87|pages=416–426|doi=10.1016/j.neuroimage.2013.06.081|pmid=23851325|s2cid=26942635}}</ref>

==Metamorphosis==
{{Further|Metamorphosis}}
[[File:Metamorphosis-Tumor-Genesis.png|alt=Illustration of changing both gray levels in an imaging which is classical warping from Michael Jackson video as well as diffeomorphic orbit transformation.,|thumb|Demonstrating metamorphosis allowing both diffeomorphic change in coordinate transformation as well as change in image intensity as associated to early [[Morphing|Morphing technologies such as the]] Michael Jackson video. Notice the insertion of tumor gray level intensity which does not exist in template.]]
The principle mode of variation represented by the orbit model is change of coordinates. For setting in which pairs of images are not related by diffeomorphisms but have photometric variation or image variation not represented by the template, [[active appearance model]]ling has been introduced, originally by Edwards-Cootes-Taylor<ref>{{Cite book|title=Active appearance models|publisher=Springer Berlin Heidelberg|date=1998-06-02|isbn=9783540646136|pages=484–498|series=Lecture Notes in Computer Science|first1=T. F.|last1=Cootes|first2=G. J.|last2=Edwards|first3=C. J.|last3=Taylor|editor-first=Hans|editor-last=Burkhardt|editor-first2=Bernd|editor-last2=Neumann}}</ref> and in 3D medical imaging in.<ref>{{Cite journal|title=Morphological appearance manifolds for group-wise morphometric analysis|journal=Medical Image Analysis|date=2011-12-01|pmc=4392008|pmid=21873104|pages=814–829|volume=15|issue=6|doi=10.1016/j.media.2011.06.003|first1=Nai-Xiang|last1=Lian|first2=Christos|last2=Davatzikos}}</ref> In the context of computational anatomy in which metrics on the anatomical orbit has been studied, '''metamorphosis''' for modelling structures such as tumors and photometric changes which are not resident in the template was introduced in<ref name=":8"/> for Magnetic Resonance image models, with many subsequent developments extending the metamorphosis framework.<ref>{{Cite book|title=Metamorphoses Through Lie Group Action|date=2005-01-01|first1=Alain|last1=Trouvé|first2=Laurent|last2=Younes|citeseerx=10.1.1.157.8752}}</ref><ref>{{Cite arXiv|title=The Euler-Poincare theory of Metamorphosis|eprint=0806.0870|date=2008-06-04|first1=Darryl D.|last1=Holm|first2=Alain|last2=Trouve|first3=Laurent|last3=Younes|class=cs.CV }}</ref><ref>{{Cite arXiv|title=Metamorphosis of Images in Reproducing Kernel Hilbert Spaces|eprint=1409.6573|date=2014-09-23|first1=Casey L.|last1=Richardson|first2=Laurent|last2=Younes|class=math.OC}}</ref>

For image matching the image metamorphosis framework enlarges the action so that <math> t \mapsto (\phi_t,I_t) </math> with action <math> \phi_t \cdot I_t \doteq I_t \circ \phi_t^{-1}  </math>. In this setting metamorphosis combines both the diffeomorphic coordinate system transformation of computational anatomy as well as the early [[morphing]] technologies which only faded or modified the photometric or image intensity alone.

Then the matching problem takes a form with equality boundary conditions:
:<math>
\min_{(v,I)}
\frac{1}{2} \int_0^1 \left( \int_X A v_t \cdot v_t dx +
\|\dot I_t \circ \phi_t^{-1} \|^2 / \sigma^2 \right) \, dt  \text{ subject to} \ \phi_0=id, I_0=\text{fixed}, I_1=\text{fixed}
</math>

==Matching landmarks, curves, surfaces==
Transforming coordinate systems based on [[Landmark point]] or [[fiducial marker]] features dates back to Bookstein's early work on small deformation spline methods<ref>{{Cite journal|title=Principal Warps: Thin-Plate Splines and the Decomposition of Deformations|url=http://www.computer.org/csdl/trans/tp/1989/06/i0567.pdf|journal=IEEE Transactions on Pattern Analysis and Machine Intelligence|date=1989-01-01|pages=567–585|volume=11|issue=6|doi=10.1109/34.24792|first=F. L.|last=Bookstein}}</ref> for interpolating correspondences defined by fiducial points to the two-dimensional or three-dimensional background space in which the fiducials are defined. Large deformation landmark methods came on in the late 1990s.<ref name="Miller 209–228"/><ref name="Joshi 1357–1370"/><ref>{{Cite book|title=Geodesic Interpolating Splines|url=|doi=10.1007/3-540-44745-8_34|publisher=Springer Berlin Heidelberg|date=2001-09-03|isbn=9783540425236|pages=513–527|series=Lecture Notes in Computer Science|first1=Vincent|last1=Camion|first2=Laurent|last2=Younes|editor-first=Mário|editor-last=Figueiredo|editor-first2=Josiane|editor-last2=Zerubia|editor-first3=Anil K.|editor-last3=Jain|citeseerx=10.1.1.57.7394}}</ref> The above Figure depicts a series of landmarks associated three brain structures, the amygdala, entorhinal cortex, and hippocampus.

Matching geometrical objects like unlabelled point distributions, curves or surfaces is another common problem in computational anatomy. Even in the discrete setting where these are commonly given as vertices with meshes, there are no predetermined correspondences between points as opposed to the situation of landmarks described above. From the theoretical point of view, while any submanifold <math>X</math> in <math> {\mathbb R}^3 </math>, <math> d=1,2,3 </math> can be parameterized in local charts <math> m: u \in U \subset {\mathbb R}^{0,1,2,3} \rightarrow {\mathbb R}^3 </math>, all reparametrizations of these charts give geometrically the same manifold. Therefore, early on in computational anatomy, investigators have identified the necessity of parametrization invariant representations. One indispensable requirement is that the end-point matching term between two submanifolds is itself independent of their parametrizations. This can be achieved via concepts and methods borrowed from [[Geometric measure theory]], in particular [[Current (mathematics)|currents]]<ref name=":18">{{Cite journal |date=2005-01-01|pmid=17354711|pages=381–392|volume=19|first1=Marc|last1=Vaillant|first2=Joan|last2=Glaunès|s2cid=5103312|title=Surface matching via currents|journal=Information Processing in Medical Imaging : Proceedings of the ... Conference|doi=10.1007/11505730_32|series=Lecture Notes in Computer Science|isbn=978-3-540-26545-0}}</ref> and [[varifold]]s<ref name="Charon 2547–2580" /> which have been used extensively for curve and surface matching.

===Landmark or point matching with correspondence===
{{Further|Large deformation diffeomorphic metric mapping#LDDMM registered landmark matching}}
[[File:ComputationalAnatomy LandmarkGeodesic Single withLabel.gif|alt=Illustration of geodesic flow for one landmark, demonstrating diffeomorphic motion of background space. Red arrow shows p 0, blue curve shows \varphi t(x 1), black grid shows \varphi t|thumb|Illustration of geodesic flow for one landmark, demonstrating diffeomorphic motion of background space.  Red arrow shows <math>p_0(1)</math>, blue curve shows <math>\varphi_t(x_1)</math>, black grid shows <math>\varphi_t</math>]]

[[File:Joshi Landmark Matching.png|thumb|Figure showing landmark matching with correspondence.
Left and right panels depict two different kernel with solutions.
]]
Denoted the landmarked shape <math> X\doteq \{ x_1,\dots, x_n \} \subset {\mathbb R}^3 </math> with endpoint <math>
E(\phi_1) \doteq   \textstyle \sum_i \displaystyle \|\phi_1(x_i)-x_i^\prime \|^2 
</math>, the variational problem becomes

{{NumBlk|:|
:.<math>
\begin{matrix}
& \ \ \ \min_{\phi: v=\dot \phi \circ \phi^{-1}} C(\phi) \doteq \frac{1}{2} \int
     (Av_t|v_t)dt  +\frac{1}{2} \sum_i \|\phi_1(x_i) - x_i^\prime \|^2
   \end{matrix}
</math>|{{EquationRef|Landmark-Matching}}}}The geodesic Eulerian momentum is a generalized function  <math>
\displaystyle Av_t \in V^*\textstyle, t \in [0,1] 
</math>, supported on the landmarked set in the variational problem. The endpoint condition with conservation implies the initial momentum at the identity of the group:
:<math>
\begin{cases}
& \text{Endpoint Condition:} \ \ \ \ \  Av_1=\sum_{i=1}^n p_1(i)\delta_{\phi_1(x_i)}, p_1(i)=(x_i^\prime-\phi_1(x_i)) \ , 
\\
& \text{Conservation:} \ \ \ \  \ \  \ \ \ \ \  \ \ \  Av_t=\sum_{i=1}^n p_t(i) \delta_{\phi_t(x_i)}  , 
\ p_t(i)=(D\phi_{t1})_{|\phi_t(x_i)}^T p_1(i) \ , \  \phi_{t1} \doteq \phi_1 \circ \phi_t^{-1} \ ,
\\
& \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Av_0=\sum_i \delta_{x_i} (\cdot) p_0(i) \  \text{with} \ \  p_0(i)=(D\phi_1)^T_{|x_i}(x_i^\prime-\phi_1(x_i))
\end{cases}
</math>

The iterative algorithm 
[[LDDMM#Joshi's original LDDMM landmark matching|for large deformation diffeomorphic metric mapping for landmarks]] is given.

===Measure matching: unregistered landmarks===
Glaunes and co-workers first introduced diffeomorphic matching of pointsets in the general setting of matching distributions.<ref>{{Cite book|last1=Glaunes|first1=J.|last2=Trouve|first2=A.|last3=Younes|first3=L.|date=2004-06-01 |volume=2|pages=II–712–II–718 Vol.2|doi=10.1109/CVPR.2004.1315234|isbn=978-0-7695-2158-9|citeseerx=10.1.1.158.4209|chapter=Diffeomorphic matching of distributions: A new approach for unlabelled point-sets and sub-manifolds matching|title=Proceedings of the 2004 IEEE Computer Society Conference on Computer Vision and Pattern Recognition, 2004. CVPR 2004}}</ref> As opposed to landmarks, this includes in particular the situation of weighted point clouds with no predefined correspondences and possibly different cardinalities. The template and target discrete point clouds are represented as two weighted sums of Diracs <math> \mu_{m}=\sum_{i=1}^{n} \rho_i \delta_{x_i} </math> and <math> \mu_{m^\prime}=\sum_{i=1}^{n^\prime} \rho^{\prime}_{i} \delta_{x^{\prime}_{i}} </math> living in the space of [[signed measure]]s of <math> \mathbb{R}^3 </math>. The space is equipped with a Hilbert metric obtained from a real positive kernel <math> k(x,y) </math> on <math> \mathbb{R}^3 </math>, giving the following norm:

: <math>
\|\mu_{m} \|_\mathrm{mea}^2=\sum_{i,j=1}^{n} \rho_i \rho_j k(x_i,x_j)
</math>

The matching problem between a template and target point cloud may be then formulated using this kernel metric for the endpoint matching term:

: <math>
\min_{\phi: v=\dot \phi \circ \phi^{-1}} C(\phi) \doteq \frac{1}{2} \int
     (Av_t\mid v_t) \, dt  +\frac{1}{2} \|\mu_{\phi_1 \cdot m} - \mu_{m^\prime} \|_\mathrm{mea}^2
</math>

where <math> \mu_{\phi_1 \cdot m}=\sum_{i=1}^{n} \rho_i \delta_{\phi_1(x_i)} </math> is the distribution transported by the deformation.

===Curve matching===
In the one dimensional case, a curve in 3D can be represented by an embedding <math> m: u \in [0,1] \rightarrow {\mathbb R}^3 </math>, and the group action of ''Diff'' becomes <math> \phi \cdot m=\phi \circ m</math>. However, the correspondence between curves and embeddings is not one to one as the any reparametrization <math>m \circ \gamma</math>, for <math>\gamma</math> a diffeomorphism of the interval [0,1], represents geometrically the same curve. In order to preserve this invariance in the end-point matching term, several extensions of the previous 0-dimensional measure matching approach can be considered.

* '''Curve matching with currents'''
In the situation of oriented curves, currents give an efficient setting to construct invariant matching terms. In such representation, curves are interpreted as elements of a functional space dual to the space vector fields, and compared through kernel norms on these spaces. Matching of two curves <math> m</math> and <math> m^\prime</math> writes eventually as the variational problem

: <math>
\min_{\phi: v=\dot \phi \circ \phi^{-1}} C(\phi) \doteq \frac{1}{2} \int
     (Av_t\mid v_t) \, dt  +\frac{1}{2} \|\mathcal{C}_{\phi_1 \cdot m} - \mathcal{C}_{m^\prime} \|_\mathrm{cur}^2
</math>

with the endpoint term <math> E(\phi_1)=\|\mathcal{C}_{\phi_1 \cdot m} - \mathcal{C}_{m^\prime} \|_\mathrm{cur}^2/2 </math> is obtained from the norm

: <math>
\|\mathcal{C}_{m} \|_\mathrm{cur}^2=\int_0^1 \int_0^1 K_C(m(u),m(v)) \partial m(u) \cdot \partial m(v) \, du \, dv
</math>

the derivative <math> \partial m(u)</math> being the tangent vector to the curve and <math> K_{\mathcal{C}} </math> a given matrix kernel of <math> {\mathbb R}^3 </math>. Such expressions are invariant to any positive reparametrizations of <math> m</math> and <math> m'</math>, and thus still depend on the orientation of the two curves.

* '''Curve matching with varifolds'''
Varifold is an alternative to currents when orientation becomes an issue as for instance in situations involving multiple bundles of curves for which no "consistent" orientation may be defined. Varifolds directly extend 0-dimensional measures by adding an extra tangent space direction to the position of points, leading to represent curves as measures on the product of <math> {\mathbb R}^3 </math> and the [[Grassmannian]] of all straight lines in <math> {\mathbb R}^3 </math>. The matching problem between two curves then consists in replacing the endpoint matching term by <math> E(\phi_1)=\|\mathcal{V}_{\phi_1 \cdot m} - \mathcal{V}_{m^\prime} \|_{cur}^2/2 </math> with varifold norms of the form:

: <math>
\|\mathcal{V}_m \|_{var}^2=\int_{0}^1 \int_{0}^1 k_{\mathbb{R}^3}(m(u),m(v)) k_{\mathbf{Gr}}\left([\partial m(u)],[\partial m(v)] \right) {{|}}\partial m(u){{|}} {{|}}\partial m(v) {{|}} \, du \, dv 
</math>

where <math> [\partial m(u)]</math> is the non-oriented line directed by tangent vector <math> \partial m(u)</math> and <math>k_{\mathbb{R}^3}, k_{\mathbf{Gr}}</math> two scalar kernels respectively on  <math>\mathbb{R}^3</math> and the Grassmannian. Due to the inherent non-oriented nature of the Grassmannian representation, such expressions are invariant to positive and negative reparametrizations.

===Surface matching===
Surface matching share many similarities with the case of curves. Surfaces in <math> {\mathbb R}^3 </math> are parametrized in local charts by embeddings <math> m: u \in U \subset {\mathbb R}^{2} \rightarrow {\mathbb R}^3 </math>, with all reparametrizations <math> m\circ \gamma </math> with <math> \gamma </math> a diffeomorphism of U being equivalent geometrically. Currents and varifolds can be also used to formalize surface matching.

* '''Surface matching with currents'''
Oriented surfaces can be represented as 2-currents which are dual to differential 2-forms. In <math> {\mathbb R}^3 </math>, one can further identify 2-forms with vector fields through the standard wedge product of 3D vectors. In that setting, surface matching writes again:

: <math>
\min_{\phi: v=\dot \phi \circ \phi^{-1}} C(\phi) \doteq \frac{1}{2} \int
     (Av_t\mid v_t) \, dt  +\frac{1}{2} \|\mathcal{C}_{\phi_1 \cdot m} - \mathcal{C}_{m^\prime} \|_\mathrm{cur}^2
</math>

with the endpoint term <math> E(\phi_1)=\|\mathcal{C}_{\phi_1 \cdot m} - \mathcal{C}_{m^\prime} \|_\mathrm{cur}^2/2 </math> given through the norm

: <math>
\|\mathcal{C}_{m} \|_\mathrm{cur}^2=\iint_{U\times U} K_C(m(u),m(v)) \vec{n}(u) \cdot \vec{n}(v) \, du \, dv
</math>

with <math> \vec{n}=\partial_{u_1} m \wedge \partial_{u_2} m </math> the normal vector to the surface parametrized by <math> m </math>.

This surface mapping algorithm has been validated for brain cortical surfaces against CARET and FreeSurfer.<ref>{{cite journal|last1=Zhong|first1=J|last2=Phua|first2=DY|last3=Qiu|first3=A|title=Quantitative evaluation of LDDMM, FreeSurfer, and CARET for cortical surface mapping|journal=NeuroImage|date=2010|volume=52|issue=1|pages=131–141|doi=10.1016/j.neuroimage.2010.03.085|pmid=20381626|s2cid=6767322}}</ref> LDDMM mapping for multiscale surfaces is discussed in.<ref>{{cite journal|last1=Tan|first1=M|last2=Qiu|first2=A|title=Large Deformation Multiresolution Diffeomorphic Metric Mapping for Multiresolution Cortical Surfaces: A Coarse-to-Fine Approach|journal=IEEE Trans. Image Process.|date=2016|volume=25|issue=9|pages=4061–4074|doi=10.1109/TIP.2016.2574982|pmid=27254865|bibcode=2016ITIP...25.4061T|s2cid=16307639}}</ref>

* '''Surface matching with varifolds'''
For non-orientable or non-oriented surfaces, the varifold framework is often more adequate. Identifying the parametric surface <math> m </math> with a varifold <math> \mathcal{V}_m </math> in the space of measures on the product of <math> {\mathbb R}^3 </math> and the Grassmannian, one simply replaces the previous current metric <math> \|\mathcal{C}_{m} \|_\mathrm{cur}^2 </math> by:

: <math>
\|\mathcal{V}_{m} \|_\mathrm{var}^2=\iint_{U\times U} k_{\mathbb{R}^3}(m(u),m(v)) k_{\mathbf{Gr}}\left([\vec{n}(u)],[\vec{n}(v)] \right) {{|}}\vec{n}(u){{|}} {{|}}\vec{n}(v) {{|}} \, du \, dv
</math>

where <math> [\vec{n}(u)] </math> is the (non-oriented) line directed by the normal vector to the surface.

==Growth and atrophy from longitudinal time-series==

There are many settings in which there are a series of measurements, a time-series to which the underlying
coordinate systems will be matched and flowed onto. This occurs for example
in the dynamic growth and atrophy models and motion tracking such as have been explored in<ref name=":15">{{Cite journal|title=Computational anatomy: shape, growth, and atrophy comparison via diffeomorphisms|journal=NeuroImage|date=2004-01-01|pmid=15501089|pages=S19–33|volume=23 Suppl 1|doi=10.1016/j.neuroimage.2004.07.021|first=Michael I.|last=Miller|citeseerx=10.1.1.121.4222|s2cid=13365411}}</ref><ref>{{Cite journal|title=Geodesic regression for image time-series|journal=Medical Image Computing and Computer-assisted Intervention: MICComputational AnatomyI ... International Conference on Medical Image Computing and Computer-Assisted Intervention|date=2011-01-01|pmc=4339064|pmid=21995085|pages=655–662|volume=14|issue=Pt 2|first1=Marc|last1=Niethammer|first2=Yang|last2=Huang|first3=François-Xavier|last3=Vialard|doi=10.1007/978-3-642-23629-7_80}}</ref><ref name=":16">{{Cite arXiv|title=Shape Splines and Stochastic Shape Evolutions: A Second Order Point of View|eprint=1003.3895|last1=Trouvé|first1=Alain|last2=Vialard|first2=François-Xavier|class=math.OC|year=2010 }}</ref><ref name=":17">{{Cite journal|title=Principal geodesic analysis for the study of nonlinear statistics of shape|journal=IEEE Transactions on Medical Imaging|date=2004-08-01|pages=995–1005|volume=23|issue=8|doi=10.1109/TMI.2004.831793|pmid=15338733|first1=P.T.|last1=Fletcher|first2=C.|last2=Lu|first3=S.M.|last3=Pizer|first4=S.|last4=Joshi|citeseerx=10.1.1.76.539|s2cid=620015}}</ref> An observed time sequence is given and the goal is to infer the time flow of geometric change of coordinates carrying the exemplars or templars through the period of observations.

The generic time-series matching problem considers the series of times is <math>0 < t_1 < \dots t_K=1</math>. The flow optimizes at the series of costs <math>E(t_k), k=1, \dots, K</math> giving optimization problems of the form

: <math>\min_{\phi:v=\dot \phi \circ \phi^{-1}, \phi_0=id} C(\phi) \doteq \frac{1}{2} \int_0^1 (Av_t\mid v_t) \, dt +\sum_{k=1}^K E( \phi_{t_k})
</math>.

There have been at least three solutions offered thus far, piecewise geodesic,<ref name=":15"/> principal geodesic<ref name=":17"/> and splines.<ref>{{Cite journal|title=Shape splines and stochastic shape evolutions: A second order point of view|journal=Quarterly of Applied Mathematics|date=2012-01-01|pages=219–251|volume=70|issue=2|doi=10.1090/S0033-569X-2012-01250-4|first1=Alain|last1=Trouvé|first2=François-Xavier|last2=Vialard|arxiv=1003.3895|s2cid=96421820}}</ref>

==The random orbit model of computational anatomy==
[[File:Showing orbit as a surface.jpg|alt=Carton depicting random orbit of brains via a smooth manifold.|thumb|Orbits of brains associated to diffeomorphic group action on templates depicted via smooth flow associated to geodesic flows with random spray associated to random generation of initial tangent space vector field <math>v_0 \in V</math>; published in.<ref name="Miller 36"/>]]
The '''random orbit model'''  of computational anatomy first appeared in<ref name=":1">{{Cite journal|title=Statistical methods in computational anatomy|journal=Statistical Methods in Medical Research|date=1997-06-01|pmid=9339500|pages=267–299|volume=6|issue=3|doi=10.1177/096228029700600305|first1=Michael|last1=Miller|first2=Ayananshu|last2=Banerjee|first3=Gary|last3=Christensen|first4=Sarang|last4=Joshi|first5=Navin|last5=Khaneja|first6=Ulf|last6=Grenander|first7=Larissa|last7=Matejic|s2cid=35247542}}</ref><ref name=":9">{{Cite book|title=Pattern Theory: From Representation to Inference|author=U. Grenander and M. I. Miller|publisher=Oxford University Press|date=2007-02-08|isbn=9780199297061}}</ref><ref name=":19">{{Cite book|title=Bayesian Multiple Atlas Deformable Templates|author=M. I. Miller and S. Mori and X. Tang and D. Tward and Y. Zhang|series=Brain Mapping: An Encyclopedic Reference|url=https://books.google.com/books?id=ysucBAAAQBAJ|publisher=Academic Press|date=2015-02-14|isbn=9780123973160}}</ref> modelling the change in coordinates associated to the randomness of the group acting on the templates, which induces the randomness on the source of images in the anatomical orbit of shapes and forms and resulting observations through the medical imaging devices. Such a '''random orbit model''' in which randomness on the group induces randomness on the images was examined for the Special Euclidean Group for object recognition in.<ref>{{Cite book|title=Ergodic Algorithms on Special Euclidean Groups for ATR|doi=10.1007/978-1-4612-4120-1_18|publisher=Birkhäuser Boston|date=1997-01-01|isbn=978-1-4612-8662-2|pages=327–350|series=Systems & Control: Foundations & Applications|first1=S.|last1=Srivastava|first2=M. I.|last2=Miller|first3=U.|last3=Grenander|editor-first=Christopher I.|editor-last=Byrnes|editor-first2=Biswa N.|editor-last2=Datta|editor-first3=Clyde F.|editor-last3=Martin|editor-first4=David S.|editor-last4=Gilliam|citeseerx=10.1.1.44.4751}}</ref>

Depicted in the figure is a depiction of the random orbits around each exemplar, <math>m_0 \in \mathcal{M}</math>, generated by randomizing the flow by generating the initial tangent space vector field at the identity <math>v_0 \in V</math>, and then generating random object <math>n \doteq Exp_{id}(v_0) \cdot m_0 \in \mathcal{M}</math>.

The random orbit model induces the prior on shapes and images <math>
I \in \mathcal{I}
</math> conditioned on a particular atlas <math>
I_a \in \mathcal{I}
</math>. For this the generative model generates the mean field <math>
I
</math> as a random change in coordinates of the template according to <math>
I \doteq \phi \cdot I_a 
</math>, where the diffeomorphic change in coordinates is generated randomly via the geodesic flows. The prior on random transformations <math>
\pi_{Diff} (d\phi)
</math> on <math>Diff_V</math> is induced by the flow <math>
Exp_{id}(v)
</math>, with <math>
v \in V
</math> constructed as a Gaussian random field prior <math>
\pi_V(dv)
</math>. The density on the random observables at the output of the sensor <math>I^D \in \mathcal{I}^D</math> are given by
[[File:Synthesized cortical structures from common template.png|alt=Figure shows randomly synthesized structures|thumb|Figure showing the random spray of synthesized subcortical structures laid out in the two-dimensional grid representing the variance of the eigenfunction used for the momentum for synthesis.]]

<math>
p(I^D|I_a)=\int_V p(I^D|Exp_{id}(v) \cdot I_a ) \pi_V (dv) \ .
</math>

Shown in the Figure on the right the cartoon orbit, are a random spray of the subcortical manifolds generated by randomizing the vector fields <math>v_0</math> supported over the submanifolds.

==The Bayesian model of computational anatomy==
{{main|The Bayesian model of computational anatomy}}
[[File:Source-channel-model-Shannon.png|thumb|Source-channel model showing the source of images the deformable template <math>I \doteq \phi \cdot I_\mathrm{temp} \in \mathcal{I}</math> and channel output associated with MRI sensor <math>I^D \in \mathcal{I}^{\mathcal{D}}</math>]]
The central statistical model of computational anatomy in the context of [[medical imaging]] has been the source-channel model of [[Shannon theory]];<ref name=":1"/><ref name=":9"/><ref name=":19"/> the source is the deformable template of images <math> I \in \mathcal {I} </math>, the channel outputs are the imaging sensors with observables <math> I^D \in {\mathcal I}^{\mathcal D} </math> (see Figure).

See [[The Bayesian model of computational anatomy]] for discussions (i) MAP estimation with multiple atlases, (ii)
MAP segmentation with multiple atlases, MAP estimation of templates from populations.

==Statistical shape theory in computational anatomy==
{{Further|Statistical shape analysis|Shape theory (mathematics)}}

[[Shape]] in computational anatomy is a local theory, indexing shapes and structures to templates to which they are [[bijectively]] mapped. [[Statistical shape analysis|Statistical shape]] in computational anatomy is the empirical study of diffeomorphic correspondences between populations and common template coordinate systems.  This is a strong departure from [[Procrustes|Procrustes Analyses]] and shape theories pioneered by [[David George Kendall|David G. Kendall]]<ref>{{Cite journal|title=A Survey of the Statistical Theory of Shape|jstor=2245331|journal=Statistical Science|date=1989-01-01|pages=87–99|volume=4|issue=2|first=David G.|last=Kendall|doi=10.1214/ss/1177012582|doi-access=free}}</ref> in that the central group of Kendall's theories are the finite-dimensional Lie groups, whereas the theories of shape in computational anatomy<ref>{{Cite book|doi=10.1007/978-88-7642-387-1_4|publisher=Scuola Normale Superiore|date=2012-01-01|isbn=9788876423888|pages=43–53|series=Colloquia|first=David|last=Mumford|s2cid=116135355|editor-first=Umberto|editor-last=Zannier|title=Colloquium de Giorgi 2009|chapter=The geometry and curvature of shape spaces}}</ref><ref>{{Cite book|edition=1st|title=Shapes and Diffeomorphisms|author=Laurent Younes|publisher=Springer|date=2010-05-25|isbn=9783642120541 }}</ref><ref>{{Cite journal|title=Spaces and Manifolds of Shapes in Computer Vision: An Overview|journal=Image Vision Comput.|date=2012-06-01|pages=389–397|volume=30|issue=6–7|doi=10.1016/j.imavis.2011.09.009|first=Laurent|last=Younes}}</ref> have focused on the diffeomorphism group, which to first order via the Jacobian can be thought of as a field–thus infinite dimensional–of low-dimensional Lie groups of scale and rotations. 
[[File:Subcortical structures embedded in two-dimensional momentum space.png|alt=showing man sub-cortical structures|thumb|Figure showing hundreds of sub-cortical structures embedded in two-dimensional momentum space generated from the first two eigenvectors of the empirical co-variance estimated from the population of shapes.]]
The random orbit model provides the natural setting to understand empirical shape and shape statistics within computational anatomy since the non-linearity of the induced probability law on anatomical shapes and forms <math> m \in \mathcal{M} </math> is induced via the reduction to the vector fields <math> v_0 \in V </math> at the tangent space at the identity of the diffeomorphism group. The successive flow of the Euler equation induces the random space of shapes and forms <math>Exp_{id}(v_0) \cdot m \in \mathcal{M}</math>.

Performing empirical statistics on this tangent space at the identity is the natural way for inducing probability laws on the statistics of shape. Since both the vector fields and the Eulerian momentum <math>Av_0</math> are in a Hilbert space the natural model is one of a Gaussian random field, so that given test function <math>w \in V</math>, then the inner-products with the test functions are Gaussian distributed with mean and covariance.

This is depicted in the accompanying figure where sub-cortical brain structures are depicted in a two-dimensional coordinate system based on inner products of their initial vector fields that generate them from the template is shown in a 2-dimensional span of the Hilbert space.

==Template estimation from populations==
[[File:Template-generation.png|alt=figure depicting multiple coordinate systems generated from MRI images and generating a common template coordinate system.|thumb|Depicting template estimation from multiplie subcortical surfaces in populations of MR images using the EM-algorithm solution of Ma.<ref name="ncbi.nlm.nih.gov">{{Cite journal|title=A Bayesian Generative Model for Surface Template Estimation|journal=International Journal of Biomedical Imaging|date=2010-01-01|pmc=2946602|pmid=20885934|volume=2010|doi=10.1155/2010/974957|first1=Jun|last1=Ma|first2=Michael I.|last2=Miller|first3=Laurent|last3=Younes|pages=1–14}}</ref>]]
{{Further|The Bayesian model of computational anatomy|Bayesian estimation of templates in computational anatomy}}

The study of shape and statistics in populations are local theories, indexing shapes and structures to templates to which they are bijectively mapped. Statistical shape is then the study of diffeomorphic correspondences relative to the template. A core operation is the generation of templates from populations, estimating a shape that is matched to the population. There are several important methods for generating templates including methods based on [[Frechet]] averaging,<ref>{{Cite journal|title=Unbiased diffeomorphic atlas construction for computational anatomy|journal=NeuroImage|date=2004-01-01|pages=151–160|volume=23|first1=S.|last1=Joshi|first2=Brad|last2=Davis|first3=B. Matthieu|last3=Jomier|first4=Guido Gerig|last4=B|doi=10.1016/j.neuroimage.2004.07.068|pmid=15501084|citeseerx=10.1.1.104.3808|s2cid=2271742}}</ref> and statistical approaches based on the [[expectation-maximization algorithm]] and the Bayes Random orbit models of computational anatomy.<ref name="ncbi.nlm.nih.gov"/><ref>{{Cite journal|title=Bayesian Template Estimation in Computational Anatomy|journal=NeuroImage|date=2008-08-01|pmc=2602958|pmid=18514544|pages=252–261|volume=42|issue=1|doi=10.1016/j.neuroimage.2008.03.056|first1=Jun|last1=Ma|first2=Michael I.|last2=Miller|first3=Alain|last3=Trouvé|first4=Laurent|last4=Younes}}</ref> Shown in the accompanying figure is a subcortical template reconstruction from the population of MRI subjects.<ref>{{cite journal|last1=Qiu|first1=Anqi|last2=Miller|first2=Michael I.|title=Multi-structure network shape analysis via normal surface momentum maps|journal=NeuroImage|date=2008|volume=42|issue=4|pages=1430–1438|doi=10.1016/j.neuroimage.2008.04.257|pmid=18675553|citeseerx=10.1.1.463.7231|s2cid=10434173}}</ref>

==Software for diffeomorphic mapping==
[[Software suite]]s containing a variety of diffeomorphic mapping algorithms include the following:

* ANTS<ref name="stnava/ANTs"/>
* DARTEL<ref name="Ashburner 95–113"/> [[Voxel-based morphometry]]
* DEFORMETRICA<ref>{{Cite web|url=http://www.deformetrica.org/|title=Deformetrica|date=|website=|access-date=12 January 2017}}</ref>
* DEMONS<ref name="Software - Tom Vercauteren"/>
* LDDMM<ref name="NITRC: LDDMM: Tool/Resource Info"/> [[Large deformation diffeomorphic metric mapping]]
* LDDMM based on frame-based kernel <ref>{{cite web|last1=Tan|first1=Mingzhen|last2=Qiu|first2=Anqi|title=LDDMM with frame-based kernel|url=http://www.bioeng.nus.edu.sg/cfa/brainmapping.html|website=Computational Functional Anatomy}}</ref>
* StationaryLDDMM<ref name="openaire.eu"/>

===Cloud software===
* MRICloud<ref>{{Cite web|url=http://www.mricloud.org/|title=MriCloud|date=|website=|access-date=26 October 2016}}</ref>

==See also==
*[[Bayesian estimation of templates in computational anatomy]]
*[[Computational neuroanatomy]]
*[[Geometric data analysis]]
*[[Large deformation diffeomorphic metric mapping]]
*[[Procrustes analysis]]
*[[Riemannian metric and Lie-bracket in computational anatomy]]
*[[Shape analysis (disambiguation)]]
*[[Statistical shape analysis]]

==References==
{{Reflist}}

[[Category:Computational anatomy| ]]
[[Category:Physics]]
[[Category:Geometry]]
[[Category:Fluid mechanics]]
[[Category:Bayesian estimation]]
[[Category:Neuroscience]]
[[Category:Neural engineering]]
[[Category:Biomedical engineering]]
[[Category:Computational science]]