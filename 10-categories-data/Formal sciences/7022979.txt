{{short description|Combination of a likelihood function with some prior probabilities to infer the posterior probability distribution of trees given data}}
{{Infobox
 |name        = Bayesian inference in phylogeny
 |bodystyle   = width:26em
 |titlestyle  = 
 |title       = Bayesian inference in phylogeny 
|headerstyle = 
 |labelstyle  = width:33%
 |datastyle   = 
 |header1 = 
 | label1 = Classification
 |  data1 = [[Evolutionary biology]]
 |header2 = 
 | label2 = Subclassification
 |  data2 = [[Molecular phylogenetics]]
 |header3 = 
 | label3 = Optimally search criteria
 |  data3 = [[Bayesian inference]]
}}
'''Bayesian inference of phylogeny''' uses a likelihood function to create a quantity called the posterior probability of trees using a model of evolution, based on some prior probabilities, producing the most likely phylogenetic tree for the given data. The Bayesian approach has become popular due to advances in computing speeds and the integration of [[Markov chain Monte Carlo]] (MCMC) algorithms. [[Bayesian inference]] has a number of applications in [[molecular phylogenetics]] and [[systematics]].

==Bayesian inference of phylogeny background and bases==
[[File:Bayes' Theorem MMB 01.jpg|thumb|400px|Bayes' Theorem]][[File:Robot metaphor.png|thumb|Metaphor illustrating MCMC method steps]]Bayesian inference refers to a probabilistic method developed by Reverend Thomas Bayes based on [[Bayes' theorem]]. Published posthumously in 1763 it was the first expression of inverse probability and the basis of Bayesian inference. Independently, unaware of Bayes work, Pierre-Simon Laplace developed Bayes' theorem in 1774.<ref>{{cite journal | vauthors = Laplace P | date = 1774 | title = Memoire sur la Probabilite des Causes par les Evenements. | journal = L'Académie Royale des Sciences | volume = 6 | pages = 621–656 }} English translation by {{cite journal | vauthors = Stigler SM | date = 1986 | title = Memoir on the Probability of the Causes of Events | journal = Statistical Science | volume = 1 | issue = 3 | pages = 359–378 | doi = 10.1214/ss/1177013620 | doi-access = free }}</ref>

Bayesian inference was widely used until 1900s when there was a shift to frequentist inference, mainly due to computational limitations. Based on Bayes' theorem, the bayesian approach combines the prior probability of a tree P(A) with the likelihood of the data (B) to produce a posterior probability distribution on trees P(A|B). The posterior probability of a tree will indicate the probability of the tree to be correct, being the tree with the highest posterior probability the one chosen to represent best a phylogeny. It was the introduction of [[Markov chain Monte Carlo|Markov Chain Monte Carlo (MCMC)]] methods by Nicolas Metropolis in 1953 that revolutionized Bayesian Inference and by the 1990s became a widely used method amongst phylogeneticists. Some of the advantages over traditional [[maximum parsimony]] and [[maximum likelihood]] methods are the possibility of  account for the phylogenetic uncertainty, use of prior information and incorporation of complex models of evolution that limited computational analyses for traditional methods. Although overcoming complex analytical operations the posterior probability still involves a summation over all trees and, for each tree, integration over all possible combinations of substitution model parameter values and branch lengths.

MCMC methods can be described in three steps: first using a stochastic mechanism a new state for the [[Markov chain]] is proposed. Secondly, the probability of this new state to be correct is calculated. Thirdly, a new random variable (0,1) is proposed. If this new value is less than the acceptance probability the new state is accepted and the state of the chain is updated. This process is run for either thousands or millions of times. The amount of time a single tree is visited during the course of the chain is just a valid approximation of its posterior probability. Some of the most common algorithms used in  MCMC methods include the Metropolis-Hastings algorithms, the Metropolis-Coupling MCMC (MC³) and the LOCAL algorithm of Larget and Simon.

=== Metropolis-Hastings algorithm ===
One of the most common MCMC methods used is the [[Metropolis-Hastings algorithm]],<ref>{{cite journal | vauthors = Hastings WK | date = April 1970 | title = Monte Carlo sampling methods using Markov chains and their applications. | journal = Biometrika | volume = 57 | issue = 1 | pages = 97–109 | doi = 10.1093/biomet/57.1.97 | bibcode = 1970Bimka..57...97H }}</ref> a modified version of the original Metropolis algorithm.<ref name = "Metropolis_1953">{{cite journal | vauthors = Metropolis N, Rosenbluth AW, Rosenbluth MN, Teller AH, Teller E | title = Equation of state calculations by fast computing machines. | journal = The Journal of Chemical Physics | date = June 1953 | volume = 21 | issue = 6 | pages = 1087–92 | doi = 10.1063/1.1699114 | bibcode = 1953JChPh..21.1087M }}</ref> It is a widely used method to sample randomly from complicated and multi-dimensional distribution probabilities. The Metropolis algorithm is described in the following steps:<ref>{{cite book | vauthors = Felsenstein J | date = 2004 | title = Inferring phylogenies | publisher = Sinauer Associates | location = Sunderland, Massachusetts }}</ref>
# An initial tree, T<sub>i</sub>, is randomly selected
# A neighbour tree, T<sub>j</sub>, is selected from the collection of trees.
# The ratio, R, of the probabilities (or probability density functions) of T<sub>j</sub> and T<sub>i</sub> is computed as follows: R = f(T<sub>j</sub>)/f(T<sub>i</sub>)
# If R ≥ 1, T<sub>j</sub> is accepted as the current tree 
# If R < 1, T<sub>j</sub> is accepted as the current tree with probability R, otherwise T<sub>i</sub> is kept
# At this point the process is repeated from Step 2 N times.
The algorithm keeps running until it reaches an equilibrium distribution. It also assumes that the probability of proposing a new tree T<sub>j</sub> when we are at the old tree state T<sub>i</sub>, is the same probability of proposing T<sub>i</sub> when we are at T<sub>j</sub>. When this is not the case Hastings corrections are applied.
The aim of Metropolis-Hastings algorithm is to produce a collection of states with a determined distribution until the Markov process reaches a stationary distribution. The algorithm has two components:
# A potential transition from one state to another (i → j) using a transition probability function q<sub>i,j</sub>
# Movement of the chain to state j with probability α<sub>i,j</sub> and remains in i with probability 1 – α<sub>i,j</sub>.<ref name="pmid9214744">{{cite journal | vauthors = Yang Z, Rannala B | title = Bayesian phylogenetic inference using DNA sequences: a Markov Chain Monte Carlo Method | journal = Molecular Biology and Evolution | volume = 14 | issue = 7 | pages = 717–24 | date = July 1997 | pmid = 9214744 | doi = 10.1093/oxfordjournals.molbev.a025811 | doi-access = free }}</ref>

===Metropolis-coupled MCMC===
Metropolis-coupled MCMC algorithm (MC³) <ref>{{cite book | vauthors = Geyer CJ | date = 1991 | chapter = Markov chain Monte Carlo maximum likelihood. | veditors = Keramidas EM, Kaufman SM | title = Computing Science and Statistics: Proceedings of the 23rd Symposium on the Interface. | publisher = Interface Foundation | location = Fairfax Station | pages = 156–163 | oclc = 26603816 }}</ref> has been proposed to solve a practical concern of the Markov chain moving across peaks when the target distribution has multiple local peaks, separated by low valleys, are known to exist in the tree space. This is the case during heuristic tree search under maximum parsimony (MP), maximum likelihood (ML), and minimum evolution (ME) criteria, and the same can be expected for stochastic tree search using MCMC. This problem will result in samples not approximating correctly to the posterior density. The (MC³) improves the mixing of Markov chains in presence of multiple local peaks in the posterior density. It runs multiple (m) chains in parallel, each for n iterations and with different stationary distributions <math>\pi_j(.)\ </math>, <math>j = 1, 2, \ldots, m\ </math>, where the first one, <math>\pi_1 = \pi\ </math> is the target density, while <math>\pi_j\ </math>, <math>j = 2, 3, \ldots, m\ </math> are chosen to improve mixing.  For example, one can choose incremental heating of the form:

: <math> \pi_j(\theta) = \pi(\theta)^{1/[1+\lambda(j-1)]}, \ \ \lambda > 0, </math>

so that the first chain is the cold chain with the correct target density, while chains <math>2, 3, \ldots, m</math> are heated chains.  Note that raising the density <math>\pi(.)</math> to the power <math>1/T\ </math> with <math>T>1\ </math> has the effect of flattening out the distribution, similar to heating a metal.  In such a distribution, it is easier to traverse between peaks (separated by valleys) than in the original distribution.  After each iteration, a swap of states between two randomly chosen chains is proposed through a Metropolis-type step.  Let <math>\theta^{(j)}\ </math> be the current state in chain <math>j\ </math>, <math>j = 1, 2, \ldots, m\ </math>.  A swap between the states of chains <math>i\ </math> and <math>j\ </math> is accepted with probability:

:<math> \alpha = \frac{\pi_i(\theta^{(j)})\pi_j(\theta^{(i)})}{\pi_i(\theta^{(i)})\pi_j(\theta^{(j)})}\ </math>

At the end of the run, output from only the cold chain is used, while those from the hot chains are discarded.  Heuristically, the hot chains will visit the local peaks rather easily, and swapping states between chains will let the cold chain occasionally jump valleys, leading to better mixing.  However, if <math>\pi_i(\theta)/\pi_j(\theta)\ </math> is unstable, proposed swaps will seldom be accepted.  This is the reason for using several chains which differ only incrementally.

An obvious disadvantage of the algorithm is that <math>m\ </math> chains are run and only one chain is used for inference.  For this reason, <math>\mathrm{MC}^3\ </math> is ideally suited for implementation on parallel machines, since each chain will in general require the same amount of computation per iteration.

===LOCAL algorithm of Larget and Simon===
The LOCAL algorithms<ref>{{cite journal | vauthors = Larget B, Simon DL | title = Markov chain Monte Carlo algorithms for the Bayesian analysis of phylogenetic trees. | journal = Molecular Biology and Evolution | date = June 1999 | volume = 16 | issue = 6 | pages = 750–9 | doi = 10.1093/oxfordjournals.molbev.a026160 | doi-access = free }}</ref> offers a computational advantage over previous methods and demonstrates that a Bayesian approach is able to assess uncertainty computationally practical in larger trees. The LOCAL algorithm is an improvement of the GLOBAL algorithm presented in Mau, Newton and Larget (1999)<ref name="pmid11318142">{{cite journal | vauthors = Mau B, Newton MA, Larget B | title = Bayesian phylogenetic inference via Markov chain Monte Carlo methods | journal = Biometrics | volume = 55 | issue = 1 | pages = 1–12 | date = March 1999 | pmid = 11318142 | doi = 10.1111/j.0006-341x.1999.00001.x }}</ref> in which all branch lengths are changed in every cycle. The LOCAL algorithms modifies the tree by selecting an internal branch of the tree at random. The nodes at the ends of this branch are each connected to two other branches. One of each pair is chosen at random. Imagine taking these three selected edges and stringing them like a clothesline from left to right, where the direction (left/right) is also selected at random. The two endpoints of the first branch selected will have a sub-tree hanging like a piece of clothing strung to the line. The algorithm proceeds by multiplying the three selected branches by a common random amount, akin to stretching or shrinking the clothesline. Finally the leftmost of the two hanging sub-trees is disconnected and reattached to the clothesline at a location selected uniformly at random. This would be the candidate tree.

Suppose we began by selecting the internal branch with length <math>t_8\ </math> that separates taxa  <math>A\ </math> and <math>B\ </math> from the rest. Suppose also that we have (randomly) selected branches with lengths <math>t_1\ </math> and <math>t_9\ </math> from each side, and that we oriented these branches. Let <math>m = t_1+t_8+t_9\ </math>, be the current length of the clothesline. We select the new length to be <math>m^{\star} = m\exp(\lambda(U_1-0.5))\ </math>, where <math>U_1\ </math> is a uniform random variable on <math>(0,1)\ </math>. Then for the LOCAL algorithm, the acceptance probability can be computed to be:

:<math>\frac{h(y)}{h(x)} \times \frac{{m^{\star}}^3}{m^3}\ </math>

====Assessing convergence====
To estimate a branch length <math>t</math> of a 2-taxon tree under JC, in which <math>n_1</math> sites are unvaried and <math>n_2</math> are variable, assume exponential prior distribution with rate <math>\lambda\ </math>. The density is <math>p(t) = \lambda e^{-\lambda t}\ </math>. The probabilities of the possible site patterns are:

:<math>1/4\left(1/4+3/4e^{-4/3t}\right)\ </math>

for unvaried sites, and

:<math> 1/4\left(1/4-1/4e^{-4/3t}\right)\ </math>

Thus the unnormalized posterior distribution is:

: <math> h(t) =  \left(1/4\right)^{n_1+n_2}\left(1/4+3/4{e^{-4/3t}}^{n_1}\right)\ </math>

or, alternately,

: <math> h(t) = \left(1/4-1/4{e^{-4/3t}}^{n_2}\right)(\lambda e^{-\lambda t})\ </math>

Update branch length by choosing new value uniformly at random from a window of half-width <math>w\ </math> centered at the current value:

:<math> t^\star = |t+U|\ </math>

where <math>U\ </math>is uniformly distributed between <math>-w\ </math> and <math>w\ </math>.  The acceptance
probability is:

:<math> h(t^\star)/h(t)\ </math>

Example:  <math>n_1 = 70\ </math>, <math>n_2 = 30\ </math>.  We will compare results for two values of <math>w\ </math>, <math>w = 0.1\ </math> and <math>w = 0.5\ </math>.  In each case, we will begin with an initial length of <math>5\ </math> and update the length <math>2000\ </math> times.

==Maximum parsimony and maximum likelihood==
[[File:Tiger phylogenetic relationships.png|thumb|200px|Tiger phylogenetic relationships, bootstrap values shown in branches.]][[Image:LongBranch.png|thumb|200px|right|Example of [[long branch attraction]]. Longer branches (A & C) appear to be more closely related.&nbsp;]]There are many approaches to reconstructing phylogenetic trees, each with advantages and disadvantages, and there is no straightforward answer to “what is the best method?”. Maximum parsimony (MP) and maximum likelihood (ML) are traditional methods widely used for the estimation of phylogenies and both use character information directly, as Bayesian methods do.

Maximum Parsimony recovers one or more optimal trees based on a matrix of discrete characters for a certain group of [[taxa]] and it does not require a model of evolutionary change. MP gives the most simple explanation for a given set of data, reconstructing a phylogenetic tree that includes as few changes across the sequences as possible, this is the one that exhibits the smallest number of evolutionary steps to explain the relationship between taxa. The support of the tree branches is represented by [[Bootstrapping#Phylogenetics|bootstrap]] percentage. For the same reason that it has been widely used, its simplicity, MP has also received criticism and has been pushed into the background by ML and Bayesian methods. MP presents several problems and limitations. As shown by Felsenstein (1978), MP might be statistically inconsistent,<ref>{{cite journal | vauthors = Felsenstein J | title = Cases in which parsimony or compatibility methods will be positively misleading. | journal = Systematic Zoology | date = December 1978 | volume = 27 | issue = 4 | pages = 401–10 | doi = 10.1093/sysbio/27.4.401 }}</ref> meaning that as more and more data (e.g. sequence length) is accumulated, results can converge on an incorrect tree and lead to [[long branch attraction]], a phylogenetic phenomenon where taxa with long branches (numerous character state changes) tend to appear more closely related in the phylogeny than they really are. For morphological data, recent simulation studies suggest that parsimony may be less accurate than trees built using Bayesian approaches,<ref name="pmid28123088">{{cite journal | vauthors = Castorani MC, Reed DC, Raimondi PT, Alberto F, Bell TW, Cavanaugh KC, Siegel DA, Simons RD | display-authors = 6 | title = Fluctuations in population fecundity drive variation in demographic connectivity and metapopulation dynamics | journal = Proceedings. Biological Sciences | volume = 284 | issue = 1847 | pages = 20162086| date = January 2017 | pmid = 28123088 | pmc = 5310032 | doi = 10.1098/rspb.2016.2086 }}</ref> potentially due to overprecision,<ref name="pmid27095266">{{cite journal | vauthors = O'Reilly JE, Puttick MN, Parry L, Tanner AR, Tarver JE, Fleming J, Pisani D, Donoghue PC | title = Bayesian methods outperform parsimony but at the expense of precision in the estimation of phylogeny from discrete morphological data | journal = Biology Letters | volume = 12 | issue = 4 | pages = 20160081| date = April 2016 | pmid = 27095266 | pmc = 4881353 | doi = 10.1098/rsbl.2016.0081 }}</ref> although this has been disputed.<ref name="GoloboffTorres2018">{{cite journal| vauthors = Goloboff PA, Torres A, Arias JS |title=Weighted parsimony outperforms other methods of phylogenetic inference under models appropriate for morphology|journal=Cladistics|volume=34|issue=4|year=2018|pages=407–437|issn=0748-3007|doi=10.1111/cla.12205|doi-access=free}}</ref>  Studies using novel simulation methods have demonstrated that differences between inference methods result from the search strategy and consensus method employed, rather than the optimization used.<ref name="Garwood2020">{{cite journal | vauthors = Keating JN, Sansom RS, Sutton MD, Knight CG, Garwood RJ | title = Morphological phylogenetics evaluated using novel evolutionary simulations | journal = Systematic Biology | volume = 69| issue = 5| pages = 897–912| date = February 2020 | pmid = 32073641 | doi = 10.1093/sysbio/syaa012 | pmc = 7440746 | doi-access = free }}</ref>

As in maximum parsimony, maximum likelihood will evaluate alternative trees. However it considers the probability of each tree explaining the given data based on a model of evolution. In this case, the tree with the highest probability of explaining the data is chosen over the other ones.<ref name="Swofford1996">{{Cite book|title=Molecular Systematics, 2nd edition|last1=Swofford|first1=David L.|last2=Olsen|first2=Gary J.|last3=Waddell|first3=Peter J.|last4=Hillis|first4=David M. | name-list-style = vanc |year=1996|isbn=9780878932825|editor-last1=Hillis|editor-first1=David M.|editor-last2=Moritz|editor-first2=Craig|editor-last3=Mable|editor-first3=Barbara K.|publisher=Sinauer|location=Sunderland, MA|pages=407–514|chapter=Phylogenetic inference}}</ref> In other words, it compares how different trees predict the observed data. The introduction of a model of evolution in ML analyses presents an advantage over MP as the probability of nucleotide substitutions and rates of these substitutions are taken into account, explaining the phylogenetic relationships of taxa in a more realistic way. An important consideration of this method is the branch length, which parsimony ignores, with changes being more likely to happen along long branches than short ones. This approach might eliminate long branch attraction and explain the greater consistency of ML over MP. Although considered by many to be the best approach to inferring phylogenies from a theoretical point of view, ML is computationally intensive and it is almost impossible to explore all trees as there are too many. Bayesian inference also incorporates a model of evolution and the main advantages over MP and ML are that it is computationally more efficient than traditional methods, it quantifies and addresses the source of uncertainty and is able to incorporate complex models of evolution.

==Pitfalls and controversies==
* Bootstrap values vs Posterior Probabilities. It has been observed that bootstrap support values, calculated under parsimony or maximum likelihood, tend to be lower than the posterior probabilities obtained by Bayesian inference.<ref name="pmid12451182">{{cite journal | vauthors = Suzuki Y, Glazko GV, Nei M | title = Overcredibility of molecular phylogenies obtained by Bayesian phylogenetics | journal = Proceedings of the National Academy of Sciences of the United States of America | volume = 99 | issue = 25 | pages = 16138–43 | date = December 2002 | pmid = 12451182 | pmc = 138578 | doi = 10.1073/pnas.212646199 | bibcode = 2002PNAS...9916138S }}</ref><ref name="Alfaro2003">{{cite journal | vauthors = Alfaro ME, Zoller S, Lutzoni F | title = Bayes or bootstrap? A simulation study comparing the performance of Bayesian Markov chain Monte Carlo sampling and bootstrapping in assessing phylogenetic confidence | journal = Molecular Biology and Evolution | volume = 20 | issue = 2 | pages = 255–66 | date = February 2003 | pmid = 12598693 | doi = 10.1093/molbev/msg028 | doi-access = free }}</ref><ref name="Douady2003">{{cite journal | vauthors = Douady CJ, Delsuc F, Boucher Y, Doolittle WF, Douzery EJ | title = Comparison of Bayesian and maximum likelihood bootstrap measures of phylogenetic reliability | journal = Molecular Biology and Evolution | volume = 20 | issue = 2 | pages = 248–54 | date = February 2003 | pmid = 12598692 | doi = 10.1093/molbev/msg042 | doi-access = free }}</ref><ref>{{cite journal | vauthors = García-Sandoval R | title = Why some clades have low bootstrap frequencies and high Bayesian posterior probabilities. | journal = Israel Journal of Ecology & Evolution. | date = January 2014 | volume = 60 | issue = 1 | pages = 41–4 | doi = 10.1080/15659801.2014.937900 }}</ref> This fact leads to a number of questions such as: Do posterior probabilities lead to overconfidence in the results? Are bootstrap values more robust than posterior probabilities?
* Controversy of using prior probabilities. Using prior probabilities for Bayesian analysis has been seen by many as an advantage as it will provide a hypothesis a more realistic view of the real world. However some biologists argue about the subjectivity of Bayesian posterior probabilities after the incorporation of these priors. 
* Model choice. The results of the Bayesian analysis of a phylogeny are directly correlated to the model of evolution chosen so it is important to choose a model that fits the observed data, otherwise inferences in the phylogeny will be erroneous. Many scientists have raised questions about the interpretation of Bayesian inference when the model is unknown or incorrect. For example, an oversimplified model might give higher posterior probabilities.<ref name="pmid12451182"/><ref name="pmid14530133">{{cite journal | vauthors = Erixon P, Svennblad B, Britton T, Oxelman B | title = Reliability of Bayesian posterior probabilities and bootstrap frequencies in phylogenetics | journal = Systematic Biology | volume = 52 | issue = 5 | pages = 665–73 | date = October 2003 | pmid = 14530133 | doi = 10.1080/10635150390235485 | doi-access = free }}</ref>

==MRBAYES software==
MrBayes is a free software tool that performs Bayesian inference of phylogeny. Originally written by John P. Huelsenbeck and Frederik Ronquist in 2001.<ref name="pmid11524383">{{cite journal | vauthors = Huelsenbeck JP, Ronquist F | title = MRBAYES: Bayesian inference of phylogenetic trees | journal = Bioinformatics | location = Oxford, England | volume = 17 | issue = 8 | pages = 754–5 | date = August 2001 | pmid = 11524383 | doi = 10.1093/bioinformatics/17.8.754 | doi-access = free }}</ref> As Bayesian methods increased in popularity MrBayes became one of the software of choice for many molecular phylogeneticists. It is offered for Macintosh, Windows, and UNIX operating systems and it has a command-line interface. The program uses the standard MCMC algorithm as well as the Metropolis coupled MCMC variant. MrBayes reads aligned matrices of sequences (DNA or amino acids) in the standard [[Nexus file|NEXUS format]].<ref name="pmid11975335">{{cite journal | vauthors = Maddison DR, Swofford DL, Maddison WP | title = NEXUS: an extensible file format for systematic information | journal = Systematic Biology | volume = 46 | issue = 4 | pages = 590–621 | date = December 1997 | pmid = 11975335 | doi = 10.1093/sysbio/46.4.590 }}</ref>

MrBayes uses MCMC to approximate the posterior probabilities of trees.<ref name = "Metropolis_1953" /> The user can change assumptions of the substitution model, priors and the details of the MC³ analysis. It also allows the user to remove and add taxa and characters to the analysis. The program uses the most standard model of DNA substitution, the 4x4 also called JC69, which assumes that changes across nucleotides occurs with equal probability.<ref>{{cite book | vauthors = Jukes TH, Cantor CR | date = 1969 | title = Evolution of Protein Molecules. | location = New York | publisher = Academic Press | pages = 21–132 }}</ref> It also implements a number of 20x20 models of amino acid substitution, and codon models of DNA substitution. It offers different methods for relaxing the assumption of equal substitutions rates across nucleotide sites.<ref name="pmid8277861">{{cite journal | vauthors = Yang Z | title = Maximum-likelihood estimation of phylogeny from DNA sequences when substitution rates differ over sites | journal = Molecular Biology and Evolution | volume = 10 | issue = 6 | pages = 1396–401 | date = November 1993 | pmid = 8277861 | doi = 10.1093/oxfordjournals.molbev.a040082 | doi-access = free }}</ref> MrBayes is also able to infer ancestral states accommodating uncertainty to the phylogenetic tree and model parameters.

MrBayes 3 <ref name="pmid12912839">{{cite journal | vauthors = Ronquist F, Huelsenbeck JP | title = MrBayes 3: Bayesian phylogenetic inference under mixed models | journal = Bioinformatics | location = Oxford, England | volume = 19 | issue = 12 | pages = 1572–4 | date = August 2003 | pmid = 12912839 | doi = 10.1093/bioinformatics/btg180 | doi-access = free }}</ref> was a completely reorganized and restructured version of the original MrBayes. The main novelty was the ability of the software to accommodate heterogeneity of data sets. This new framework allows the user to mix models and take advantages of the efficiency of Bayesian MCMC analysis when dealing with different type of data (e.g. protein, nucleotide, and morphological). It uses the Metropolis-Coupling MCMC by default.

MrBayes 3.2 new version of MrBayes was released in 2012<ref name="pmid22357727">{{cite journal | vauthors = Ronquist F, Teslenko M, van der Mark P, Ayres DL, Darling A, Höhna S, Larget B, Liu L, Suchard MA, Huelsenbeck JP | title = MrBayes 3.2: efficient Bayesian phylogenetic inference and model choice across a large model space | journal = Systematic Biology | volume = 61 | issue = 3 | pages = 539–42 | date = May 2012 | pmid = 22357727 | pmc = 3329765 | doi = 10.1093/sysbio/sys029 }}</ref> The new version allows the users to run multiple analyses in parallel. It also provides faster likelihood calculations and allow these calculations to be delegated to graphics processing unites (GPUs). Version 3.2 provides wider outputs options compatible with FigTree and other tree viewers.

==List of phylogenetics software==
{{main|List of phylogenetics software}}
This table includes some of the most common phylogenetic software used for inferring phylogenies under a Bayesian framework. Some of them do not use exclusively Bayesian methods.

{| class="wikitable"
|-
! Name !! Description !! Method !! Author !! Website link
|-
|MrBayes || Phylogenetic inference || A program for Bayesian inference and model choice across a wide range of phylogenetic and evolutionary models. || Zangh, Huelsenbeck, Der Mark, Ronquist & Teslenko || https://nbisweden.github.io/MrBayes/
|-
| BEAST || Bayesian Evolutionary Analysis Sampling Trees || Bayesian inference, relaxed molecular clock, demographic history || A. J. Drummond, A. Rambaut & M. A. Suchard <ref>{{cite journal | vauthors = Drummond AJ, Suchard MA, Xie D, Rambaut A | title = Bayesian phylogenetics with BEAUti and the BEAST 1.7 | journal = Molecular Biology and Evolution | volume = 29 | issue = 8 | pages = 1969–73 | date = August 2012 | pmid = 22367748 | pmc = 3408070 | doi = 10.1093/molbev/mss075 }}</ref>|| https://beast.community
|-
| BEAST 2 || A software platform for Bayesian evolutionary analysis || Bayesian inference, [http://compevol.github.io/CBAN packages], multiple models ||  R Bouckaert, J Heled, D Kühnert, T Vaughan, CH Wu, D Xie, MA Suchard, A Rambaut, AJ Drummond.<ref name="pmid24722319">{{cite journal | vauthors = Bouckaert R, Heled J, Kühnert D, Vaughan T, Wu CH, Xie D, Suchard MA, Rambaut A, Drummond AJ | title = BEAST 2: a software platform for Bayesian evolutionary analysis | journal = PLOS Computational Biology | volume = 10 | issue = 4 | pages = e1003537 | date = April 2014 | pmid = 24722319 | pmc = 3985171 | doi = 10.1371/journal.pcbi.1003537 | bibcode = 2014PLSCB..10E3537B }}</ref> || http://www.beast2.org
|-
|PhyloBayes / PhyloBayes MPI || Bayesian Monte Carlo Markov Chain (MCMC) sampler for phylogenetic reconstruction. || Non-parametric methods for modeling among-site variation in nucleotide or amino-acid propensities. || N. Lartillot, N. Rodrigue, D. Stubbs, J. Richer <ref name="pmid15014145">{{cite journal | vauthors = Lartillot N, Philippe H | title = A Bayesian mixture model for across-site heterogeneities in the amino-acid replacement process | journal = Molecular Biology and Evolution | volume = 21 | issue = 6 | pages = 1095–109 | date = June 2004 | pmid = 15014145 | doi = 10.1093/molbev/msh112 | doi-access = free }}</ref> || http://www.atgc-montpellier.fr/phylobayes/
|-
|Bali-Phy || Simultaneous Bayesian inference of alignment and phylogeny  || Bayesian inference, alignment as well as tree search || Suchard MA, Redelings BD<ref name="pmid16679334">{{cite journal | vauthors = Suchard MA, Redelings BD | title = BAli-Phy: simultaneous Bayesian inference of alignment and phylogeny | journal = Bioinformatics (Oxford, England) | volume = 22 | issue = 16 | pages = 2047–8 | date = August 2006 | pmid = 16679334 | doi = 10.1093/bioinformatics/btl175 | doi-access = free }}</ref> || http://www.bali-phy.org
|-
| BUCKy || Bayesian concordance of gene trees || Bayesian concordance using modified greedy consensus of unrooted quartets || C. Ané, B. Larget, D.A. Baum, S.D. Smith, A. Rokas and B. Larget, S.K. Kotha, C.N. Dewey, C. Ané <ref name="pmid17095535">{{cite journal | vauthors = Ané C, Larget B, Baum DA, Smith SD, Rokas A | title = Bayesian estimation of concordance among gene trees | journal = Molecular Biology and Evolution | volume = 24 | issue = 2 | pages = 412–26 | date = February 2007 | pmid = 17095535 | doi = 10.1093/molbev/msl170 | doi-access = free }}</ref> || http://www.stat.wisc.edu/~ane/bucky/
|-
|BATWING || Bayesian Analysis of Trees With Internal Node Generation || Bayesian inference, demographic history, population splits || I. J. Wilson, D. Weale, D.Balding <ref>{{cite journal | vauthors = Wilson IJ, Weale ME, Balding DJ | title = Inferences from DNA data: population histories, evolutionary processes and forensic match probabilities. | journal = Journal of the Royal Statistical Society: Series A (Statistics in Society). | date = June 2003 | volume = 166 | issue = 2 | pages = 155–88 | doi =  10.1111/1467-985X.00264 }}</ref> || http://www.maths.abdn.ac.uk/˜ijw{{Dead link|date=June 2019 |bot=InternetArchiveBot |fix-attempted=yes }}
|-
| Bayes Phylogenies || Bayesian inference of trees using Markov Chain Monte Carlo methods || Bayesian inference, multiple models, mixture model (auto-partitioning) || M. Pagel, A. Meade<ref name="pmid16685633">{{cite journal | vauthors = Pagel M, Meade A | title = Bayesian analysis of correlated evolution of discrete characters by reversible-jump Markov chain Monte Carlo | journal = The American Naturalist | volume = 167 | issue = 6 | pages = 808–25 | date = June 2006 | pmid = 16685633 | doi = 10.1086/503444 | s2cid = 205984494 }}</ref> || http://www.evolution.rdg.ac.uk/BayesPhy.html
|-
|Armadillo Workflow Platform || Workflow platform dedicated to phylogenetic and general bioinformatic analysis || GUI wrapper around MrBayes || E. Lord, M. Leclercq, A. Boc, A.B. Diallo and V. Makarenkov<ref name="pmid22253821">{{cite journal | vauthors = Lord E, Leclercq M, Boc A, Diallo AB, Makarenkov V | title = Armadillo 1.1: an original workflow platform for designing and conducting phylogenetic analysis and simulations | journal = PLOS ONE | volume = 7 | issue = 1 | pages = e29903 | date = 2012 | pmid = 22253821 | pmc = 3256230 | doi = 10.1371/journal.pone.0029903 | bibcode = 2012PLoSO...729903L }}</ref> ||https://github.com/armadilloUQAM/armadillo2/
|-
|Geneious (MrBayes plugin) || Geneious provides genome and proteome research tools || GUI wrapper around MrBayes || A. J. Drummond,M.Suchard,V.Lefort et al. || http://www.geneious.com
|-
| TOPALi || Phylogenetic inference || GUI wrapper around MrBayes || I.Milne, D.Lindner, et al.<ref name="pmid18984599">{{cite journal | vauthors = Milne I, Lindner D, Bayer M, Husmeier D, McGuire G, Marshall DF, Wright F | title = TOPALi v2: a rich graphical interface for evolutionary analyses of multiple alignments on HPC clusters and multi-core desktops | journal = Bioinformatics (Oxford, England) | volume = 25 | issue = 1 | pages = 126–7 | date = January 2009 | pmid = 18984599 | pmc = 2638937 | doi = 10.1093/bioinformatics/btn575 }}</ref> || http://www.topali.org

|}

== Applications ==
Bayesian Inference has extensively been used by molecular phylogeneticists for a wide number of applications. Some of these include: [[File:Divergence time estimation and ancestral area reconstruction of porcini s.s..png|thumb|Chronogram obtained from molecular clock analysis using BEAST. Pie chart in each node indicates the possible ancestral distributions inferred from Bayesian Binary MCMC analysis (BBM)]]
* Inference of phylogenies.<ref>{{cite journal | vauthors = Alonso R, Crawford AJ, Bermingham E | title = Molecular phylogeny of an endemic radiation of Cuban toads (Bufonidae: Peltophryne) based on mitochondrial and nuclear genes. | journal = Journal of Biogeography | date = March 2012 | volume = 39 | issue = 3 | pages = 434–51 | doi = 10.1111/j.1365-2699.2011.02594.x }}</ref><ref name="pmid21856636">{{cite journal | vauthors = Antonelli A, Sanmartín I | title = Mass extinction, gradual cooling, or rapid radiation? Reconstructing the spatiotemporal evolution of the ancient angiosperm genus Hedyosmum (Chloranthaceae) using empirical and simulated approaches | journal = Systematic Biology | volume = 60 | issue = 5 | pages = 596–615 | date = October 2011 | pmid = 21856636 | doi = 10.1093/sysbio/syr062 | doi-access = free }}</ref>
* Inference and evaluation of uncertainty of phylogenies.<ref name="pmid22741602">{{cite journal | vauthors = de Villemereuil P, Wells JA, Edwards RD, Blomberg SP | title = Bayesian models for comparative analysis integrating phylogenetic uncertainty | journal = BMC Evolutionary Biology | volume = 12 | pages = 102 | date = June 2012 | pmid = 22741602 | pmc = 3582467 | doi = 10.1186/1471-2148-12-102 }}</ref>
*Inference of ancestral character state evolution.<ref name="pmid16701310">{{cite journal | vauthors = Ronquist F | title = Bayesian inference of character evolution | journal = Trends in Ecology & Evolution | volume = 19 | issue = 9 | pages = 475–81 | date = September 2004 | pmid = 16701310 | doi = 10.1016/j.tree.2004.07.002 }}</ref><ref name="pmid20701742">{{cite journal | vauthors = Schäffer S, Koblmüller S, Pfingstl T, Sturmbauer C, Krisper G | title = Ancestral state reconstruction reveals multiple independent evolution of diagnostic morphological characters in the "Higher Oribatida" (Acari), conflicting with current classification schemes | journal = BMC Evolutionary Biology | volume = 10 | pages = 246 | date = August 2010 | pmid = 20701742 | pmc = 2930640 | doi = 10.1186/1471-2148-10-246 }}</ref>
* Inference of ancestral areas.<ref name="pmid22425729">{{cite journal | vauthors = Filipowicz N, Renner SS | title = Brunfelsia (Solanaceae): a genus evenly divided between South America and radiations on Cuba and other Antillean islands | journal = Molecular Phylogenetics and Evolution | volume = 64 | issue = 1 | pages = 1–11 | date = July 2012 | pmid = 22425729 | doi = 10.1016/j.ympev.2012.02.026 }}</ref>
* Molecular dating analysis.<ref name="pmid22223444">{{cite journal | vauthors = Bacon CD, Baker WJ, Simmons MP | title = Miocene dispersal drives island radiations in the palm tribe Trachycarpeae (Arecaceae) | journal = Systematic Biology | volume = 61 | issue = 3 | pages = 426–42 | date = May 2012 | pmid = 22223444 | doi = 10.1093/sysbio/syr123 | doi-access = free }}</ref><ref name="pmid24283922">{{cite journal | vauthors = Särkinen T, Bohs L, Olmstead RG, Knapp S | title = A phylogenetic framework for evolutionary study of the nightshades (Solanaceae): a dated 1000-tip tree | journal = BMC Evolutionary Biology | volume = 13 | pages = 214 | date = September 2013 | pmid = 24283922 | pmc = 3850475 | doi = 10.1186/1471-2148-13-214 }}</ref>
* Model dynamics of species diversification and extinction<ref name="pmid24510972">{{cite journal | vauthors = Silvestro D, Schnitzler J, Liow LH, Antonelli A, Salamin N | title = Bayesian estimation of speciation and extinction from incomplete fossil occurrence data | journal = Systematic Biology | volume = 63 | issue = 3 | pages = 349–67 | date = May 2014 | pmid = 24510972 | pmc = 4361715 | doi = 10.1093/sysbio/syu006 }}</ref>
* Elucidate patterns in pathogens dispersal.<ref name="pmid19779555">{{cite journal | vauthors = Lemey P, Rambaut A, Drummond AJ, Suchard MA | title = Bayesian phylogeography finds its roots | journal = PLOS Computational Biology | volume = 5 | issue = 9 | pages = e1000520 | date = September 2009 | pmid = 19779555 | pmc = 2740835 | doi = 10.1371/journal.pcbi.1000520 | bibcode = 2009PLSCB...5E0520L }}</ref>
{{clear}}

== References ==
{{Reflist|30em}}

== External links==
* [http://mrbayes.sourceforge.net/ MrBayes official website]
* [http://beast.bio.ed.ac.uk/ BEAST official website]

{{Phylogenetics}}

[[Category:Bioinformatics]]
[[Category:Computational phylogenetics]]
[[Category:Applications of Bayesian inference|Phylogeny]]